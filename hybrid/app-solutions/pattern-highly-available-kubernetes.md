---
title: Kubernetes-Muster für Hochverfügbarkeit mit Azure und Azure Stack Hub
description: Es wird beschrieben, wie über eine Kubernetes-Clusterlösung mit Azure und Azure Stack Hub Hochverfügbarkeit erzielt werden kann.
author: BryanLa
ms.topic: article
ms.date: 12/03/2020
ms.author: bryanla
ms.reviewer: bryanla
ms.lastreviewed: 12/03/2020
ms.openlocfilehash: 454cc0a0531882b7a8ec050a461420ce13eebcfe
ms.sourcegitcommit: df7e3e6423c3d4e8a42dae3d1acfba1d55057258
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96912001"
---
# <a name="high-availability-kubernetes-cluster-pattern"></a><span data-ttu-id="d4f2f-103">Muster für Kubernetes-Cluster mit Hochverfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="d4f2f-103">High availability Kubernetes cluster pattern</span></span>

<span data-ttu-id="d4f2f-104">In diesem Artikel wird beschrieben, wie Sie eine hoch verfügbare Kubernetes-basierte Infrastruktur erstellen und betreiben, indem Sie eine AKS-Engine (Azure Kubernetes Service) unter Azure Stack Hub verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-104">This article describes how to architect and operate a highly available Kubernetes-based infrastructure using Azure Kubernetes Service (AKS) Engine on Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-105">Dieses Szenario trifft häufig für Organisationen mit kritischen Workloads in Umgebungen mit hohen Einschränkungen und starker Regulierung zu.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-105">This scenario is common for organizations with critical workloads in highly restricted and regulated environments.</span></span> <span data-ttu-id="d4f2f-106">Beispiele hierfür sind Organisationen in den Bereichen Finanzen, Verteidigung und Behörden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-106">Organizations in domains such as finance, defense, and government.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="d4f2f-107">Kontext und Problem</span><span class="sxs-lookup"><span data-stu-id="d4f2f-107">Context and problem</span></span>

<span data-ttu-id="d4f2f-108">Viele Organisationen entwickeln cloudnative Lösungen, für die moderne Dienste und Technologien, z. B. Kubernetes, genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-108">Many organizations are developing cloud-native solutions that leverage state-of-the-art services and technologies like Kubernetes.</span></span> <span data-ttu-id="d4f2f-109">Zwar sind in den meisten Regionen der Welt Azure-Rechenzentren vorhanden, aber es gibt auch spezielle Anwendungsfälle und Szenarien, bei denen unternehmenskritische Anwendungen an einem besonderen Ort ausgeführt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-109">Although Azure provides datacenters in most regions of the world, sometimes there are edge use-cases and scenarios where business critical applications must run in a specific location.</span></span> <span data-ttu-id="d4f2f-110">Diese Aspekte spielen eine Rolle:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-110">Considerations include:</span></span>

- <span data-ttu-id="d4f2f-111">Vertraulichkeitsgrad des Orts</span><span class="sxs-lookup"><span data-stu-id="d4f2f-111">Location sensitivity</span></span>
- <span data-ttu-id="d4f2f-112">Latenz zwischen der Anwendung und lokalen Systemen</span><span class="sxs-lookup"><span data-stu-id="d4f2f-112">Latency between the application and on-premises systems</span></span>
- <span data-ttu-id="d4f2f-113">Bandbreitenschutz</span><span class="sxs-lookup"><span data-stu-id="d4f2f-113">Bandwidth conservation</span></span>
- <span data-ttu-id="d4f2f-114">Konnektivität</span><span class="sxs-lookup"><span data-stu-id="d4f2f-114">Connectivity</span></span>
- <span data-ttu-id="d4f2f-115">Regulierungsbedingte oder gesetzliche Anforderungen</span><span class="sxs-lookup"><span data-stu-id="d4f2f-115">Regulatory or statutory requirements</span></span>

<span data-ttu-id="d4f2f-116">Die meisten dieser Anforderungen können durch die Verwendung von Azure mit Azure Stack Hub erfüllt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-116">Azure, in combination with Azure Stack Hub, addresses most of these concerns.</span></span> <span data-ttu-id="d4f2f-117">Im Folgenden sind viele Optionen, Entscheidungsmöglichkeiten und Aspekte beschrieben, die für eine erfolgreiche Implementierung von Kubernetes unter Azure Stack Hub berücksichtigt werden sollten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-117">A broad set of options, decisions, and considerations for a successful implementation of Kubernetes running on Azure Stack Hub is described below.</span></span>

## <a name="solution"></a><span data-ttu-id="d4f2f-118">Lösung</span><span class="sxs-lookup"><span data-stu-id="d4f2f-118">Solution</span></span>

<span data-ttu-id="d4f2f-119">Bei diesem Muster wird davon ausgegangen, dass hohe Einschränkungen bestehen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-119">This pattern assumes that we have to deal with a strict set of constraints.</span></span> <span data-ttu-id="d4f2f-120">Die Anwendung muss lokal ausgeführt werden, und alle personenbezogenen Daten dürfen nicht in die öffentliche Cloud gelangen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-120">The application must run on-premises and all personal data must not reach public cloud services.</span></span> <span data-ttu-id="d4f2f-121">Überwachungsdaten und andere Daten, bei denen es sich nicht um personenbezogene Informationen handelt, können an die Azure-Umgebung gesendet und darin verarbeitet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-121">Monitoring and other non-PII data can be sent to Azure and be processed there.</span></span> <span data-ttu-id="d4f2f-122">Auf externe Dienste, z. B. eine öffentliche Container Registry-Instanz usw., kann zugegriffen werden, aber unter Umständen erfolgt eine Filterung durch eine Firewall oder einen Proxyserver.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-122">External services like a public Container Registry or others can be accessed but might be filtered through a firewall or proxy server.</span></span>

<span data-ttu-id="d4f2f-123">Die hier dargestellte Beispielanwendung (basiert auf [Azure Kubernetes Service-Workshop](/learn/modules/aks-workshop/)) ist so konzipiert, dass nach Möglichkeit native Kubernetes-Lösungen genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-123">The sample application shown here (based on [Azure Kubernetes Service Workshop](/learn/modules/aks-workshop/)) is designed to use Kubernetes-native solutions whenever possible.</span></span> <span data-ttu-id="d4f2f-124">Bei diesem Ansatz wird die Abhängigkeit von Anbietern vermieden, und es werden keine plattformnativen Dienste genutzt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-124">This design avoids vendor lock-in, instead of using platform-native services.</span></span> <span data-ttu-id="d4f2f-125">Beispielsweise wird für die Anwendung anstelle eines PaaS-Diensts oder eines externen Datenbankdiensts ein Back-End mit einer selbstgehosteten MongoDB-Datenbank verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-125">As an example, the application uses a self-hosted MongoDB database backend instead of a PaaS service or external database service.</span></span>

<span data-ttu-id="d4f2f-126">[![Anwendungsmuster: Hybrid](media/pattern-highly-available-kubernetes/application-architecture.png)](media/pattern-highly-available-kubernetes/application-architecture.png#lightbox)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-126">[![Application Pattern Hybrid](media/pattern-highly-available-kubernetes/application-architecture.png)](media/pattern-highly-available-kubernetes/application-architecture.png#lightbox)</span></span>

<span data-ttu-id="d4f2f-127">Im obigen Diagramm ist die Anwendungsarchitektur der Beispielanwendung dargestellt, die unter Kubernetes und Azure Stack Hub ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-127">The preceding diagram illustrates the application architecture of the sample application running on Kubernetes on Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-128">Die App besteht aus mehreren Komponenten, z. B.:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-128">The app consists of several components, including:</span></span>

 1) <span data-ttu-id="d4f2f-129">Einer AKS-Engine, die auf einem Kubernetes-Cluster unter Azure Stack Hub basiert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-129">An AKS Engine based Kubernetes cluster on Azure Stack Hub.</span></span>
 2) <span data-ttu-id="d4f2f-130">[cert-manager](https://www.jetstack.io/cert-manager/) mit einer Toolsuite für die Zertifikatverwaltung in Kubernetes, um automatisch Zertifikate von Let's Encrypt anzufordern.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-130">[cert-manager](https://www.jetstack.io/cert-manager/), which provides a suite of tools for certificate management in Kubernetes, used to automatically request certificates from Let's Encrypt.</span></span>
 3) <span data-ttu-id="d4f2f-131">Einem Kubernetes-Namespace mit den Anwendungskomponenten für das Front-End (ratings-web), die API (ratings-api) und die Datenbank (ratings-mongodb).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-131">A Kubernetes namespace that contains the application components for the front end (ratings-web), api (ratings-api), and database (ratings-mongodb).</span></span>
 4) <span data-ttu-id="d4f2f-132">Einem Eingangsdatencontroller zum Weiterleiten von HTTP/HTTPS-Datenverkehr an Endpunkte im Kubernetes-Cluster.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-132">The Ingress Controller that routes HTTP/HTTPS traffic to endpoints within the Kubernetes cluster.</span></span>

<span data-ttu-id="d4f2f-133">Die Beispielanwendung wird verwendet, um die Anwendungsarchitektur zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-133">The sample application is used to illustrate the application architecture.</span></span> <span data-ttu-id="d4f2f-134">Bei allen Komponenten handelt es sich um Beispiele.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-134">All components are examples.</span></span> <span data-ttu-id="d4f2f-135">Die Architektur umfasst nicht mehr als eine Anwendungsbereitstellung.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-135">The architecture contains only a single application deployment.</span></span> <span data-ttu-id="d4f2f-136">Zur Erzielung von Hochverfügbarkeit führen wir die Bereitstellung mindestens zweimal auf zwei verschiedenen Azure Stack Hub-Instanzen durch. Diese können entweder am selben Ort oder an zwei (oder mehr) unterschiedlichen Standorten ausgeführt werden:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-136">To achieve high availability (HA), we'll run the deployment at least twice on two different Azure Stack Hub instances - they can run either in the same location or in two (or more) different sites:</span></span>

![Infrastrukturarchitektur](media/pattern-highly-available-kubernetes/aks-azure-architecture.png)

<span data-ttu-id="d4f2f-138">Dienste wie Azure Container Registry, Azure Monitor und andere werden außerhalb von Azure Stack Hub in Azure oder lokal gehostet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-138">Services like Azure Container Registry, Azure Monitor, and others, are hosted outside Azure Stack Hub in Azure or on-premises.</span></span> <span data-ttu-id="d4f2f-139">Mit diesem Hybridentwurf wird die Lösung vor einem Szenario geschützt, bei dem der Ausfall einer einzelnen Azure Stack Hub-Instanz ein großes Problem darstellt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-139">This hybrid design protects the solution against outage of a single Azure Stack Hub instance.</span></span>

## <a name="components"></a><span data-ttu-id="d4f2f-140">Komponenten</span><span class="sxs-lookup"><span data-stu-id="d4f2f-140">Components</span></span>

<span data-ttu-id="d4f2f-141">Die Gesamtarchitektur umfasst die folgenden Komponenten:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-141">The overall architecture consists of the following components:</span></span>

<span data-ttu-id="d4f2f-142">**Azure Stack Hub** ist eine Erweiterung von Azure, mit der Workloads in einer lokalen Umgebung ausgeführt werden können, indem Azure-Dienste in Ihrem Rechenzentrum bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-142">**Azure Stack Hub** is an extension of Azure that can run workloads in an on-premises environment by providing Azure services in your datacenter.</span></span> <span data-ttu-id="d4f2f-143">Weitere Informationen finden Sie unter [Übersicht über Azure Stack Hub](/azure-stack/operator/azure-stack-overview).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-143">Go to [Azure Stack Hub overview](/azure-stack/operator/azure-stack-overview) to learn more.</span></span>

<span data-ttu-id="d4f2f-144">Die **Azure Kubernetes Service-Engine (AKS-Engine)** ist die Engine im Hintergrund des verwalteten Kubernetes-Dienstangebots (Azure Kubernetes Service, AKS), das derzeit in Azure verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-144">**Azure Kubernetes Service Engine (AKS Engine)** is the engine behind the managed Kubernetes service offering, Azure Kubernetes Service (AKS), that is available in Azure today.</span></span> <span data-ttu-id="d4f2f-145">Für Azure Stack Hub ermöglicht die AKS-Engine die Bereitstellung, Skalierung und Aktualisierung von selbst verwalteten Kubernetes-Clustern mit vollem Funktionsumfang, indem die IaaS-Funktionen von Azure Stack Hub genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-145">For Azure Stack Hub, AKS Engine allows us to deploy, scale, and upgrade fully featured, self-managed Kubernetes clusters using Azure Stack Hub's IaaS capabilities.</span></span> <span data-ttu-id="d4f2f-146">Weitere Informationen finden Sie in der [Übersicht über die AKS-Engine](https://github.com/Azure/aks-engine).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-146">Go to [AKS Engine Overview](https://github.com/Azure/aks-engine) to learn more.</span></span>

<span data-ttu-id="d4f2f-147">Weitere Informationen zu den Unterschieden zwischen der AKS-Engine unter Azure und unter Azure Stack Hub finden Sie in [diesem Abschnitt zu den bekannten Problemen und Einschränkungen](https://github.com/Azure/aks-engine/blob/master/docs/topics/azure-stack.md#known-issues-and-limitations).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-147">Go to [Known Issues and Limitations](https://github.com/Azure/aks-engine/blob/master/docs/topics/azure-stack.md#known-issues-and-limitations) to learn more about the differences between AKS Engine on Azure and AKS Engine on Azure Stack Hub.</span></span>

<span data-ttu-id="d4f2f-148">Ein **virtuelles Azure-Netzwerk (Azure Virtual Network, VNET)** wird verwendet, um die Netzwerkinfrastruktur auf den einzelnen Azure Stack Hub-Instanzen für die virtuellen Computer (VMs) bereitzustellen, von denen die Infrastruktur für die Kubernetes-Cluster gehostet wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-148">**Azure Virtual Network (VNet)** is used to provide the network infrastructure on each Azure Stack Hub for the Virtual Machines (VMs) hosting the Kubernetes cluster infrastructure.</span></span>

<span data-ttu-id="d4f2f-149">**Azure Load Balancer** wird für den Kubernetes-API-Endpunkt und den NGINX-Eingangsdatencontroller verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-149">**Azure Load Balancer** is used for the Kubernetes API Endpoint and the Nginx Ingress Controller.</span></span> <span data-ttu-id="d4f2f-150">Das Lastenausgleichsmodul leitet externen Datenverkehr (z. B. aus dem Internet) an Knoten und VMs weiter, von denen ein bestimmter Dienst angeboten wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-150">The load balancer routes external (for example, Internet) traffic to nodes and VMs offering a specific service.</span></span>

<span data-ttu-id="d4f2f-151">**Azure Container Registry (ACR)** wird zum Speichern von privaten Docker-Images und Helm-Diagrammen genutzt, die für den Cluster bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-151">**Azure Container Registry (ACR)** is used to store private Docker images and Helm charts, which are deployed to the cluster.</span></span> <span data-ttu-id="d4f2f-152">Die AKS-Engine kann für die Authentifizierung bei Container Registry eine Azure AD-Identität verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-152">AKS Engine can authenticate with the Container Registry using an Azure AD identity.</span></span> <span data-ttu-id="d4f2f-153">Für Kubernetes ist keine ACR-Instanz erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-153">Kubernetes doesn't require ACR.</span></span> <span data-ttu-id="d4f2f-154">Sie können auch andere Containerregistrierungen nutzen, z.B. Docker-Hub.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-154">You can use other container registries, such as Docker Hub.</span></span>

<span data-ttu-id="d4f2f-155">Bei **Azure Repos** handelt es sich um einen Satz mit Tools für die Versionskontrolle, mit denen Sie Ihren Code verwalten können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-155">**Azure Repos** is a set of version control tools that you can use to manage your code.</span></span> <span data-ttu-id="d4f2f-156">Sie können auch GitHub oder andere Git-basierte Repositorys nutzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-156">You can also use GitHub or other git-based repositories.</span></span> <span data-ttu-id="d4f2f-157">Weitere Informationen finden Sie unter [Was ist Azure Repos?](/azure/devops/repos/get-started/what-is-repos).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-157">Go to [Azure Repos Overview](/azure/devops/repos/get-started/what-is-repos) to learn more.</span></span>

<span data-ttu-id="d4f2f-158">**Azure Pipelines** ist Teil von Azure DevOps Services und dient zum Durchführen von automatisierten Build-, Test- und Bereitstellungsvorgängen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-158">**Azure Pipelines** is part of Azure DevOps Services and runs automated builds, tests, and deployments.</span></span> <span data-ttu-id="d4f2f-159">Sie können auch CI/CD-Lösungen von Drittanbietern, z.B. Jenkins, verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-159">You can also use third-party CI/CD solutions such as Jenkins.</span></span> <span data-ttu-id="d4f2f-160">Weitere Informationen finden Sie unter [Was ist Azure Pipelines?](/azure/devops/pipelines/get-started/what-is-azure-pipelines).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-160">Go to [Azure Pipeline Overview](/azure/devops/pipelines/get-started/what-is-azure-pipelines) to learn more.</span></span>

<span data-ttu-id="d4f2f-161">**Azure Monitor** erfasst und speichert Metriken und Protokolle. Beispiele hierfür sind Plattformmetriken für die Azure-Dienste in der Lösung und Anwendungstelemetrie.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-161">**Azure Monitor** collects and stores metrics and logs, including platform metrics for the Azure services in the solution and application telemetry.</span></span> <span data-ttu-id="d4f2f-162">Nutzen Sie diese Daten zum Überwachen der Anwendung, Einrichten von Warnungen und Dashboards und Durchführen von Analysen der Grundursache von Fehlern.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-162">Use this data to monitor the application, set up alerts and dashboards, and perform root cause analysis of failures.</span></span> <span data-ttu-id="d4f2f-163">Azure Monitor wird mit Kubernetes integriert, um Metriken von Controllern, Knoten und Containern sowie aus den Protokollen von Containern und Masterknoten zu erfassen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-163">Azure Monitor integrates with Kubernetes to collect metrics from controllers, nodes, and containers, as well as container logs and master node logs.</span></span> <span data-ttu-id="d4f2f-164">Weitere Informationen finden Sie unter [Azure Monitor – Übersicht](/azure/azure-monitor/overview).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-164">Go to [Azure Monitor Overview](/azure/azure-monitor/overview) to learn more.</span></span>

<span data-ttu-id="d4f2f-165">**Azure Traffic Manager** ist ein DNS-basiertes Lastenausgleichsmodul, mit dem Sie Datenverkehr optimal an Dienste in unterschiedlichen Azure-Regionen oder Azure Stack Hub-Bereitstellungen verteilen können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-165">**Azure Traffic Manager** is a DNS-based traffic load balancer that enables you to distribute traffic optimally to services across different Azure regions or Azure Stack Hub deployments.</span></span> <span data-ttu-id="d4f2f-166">Zudem sorgt Traffic Manager für Hochverfügbarkeit und eine gute Reaktionsfähigkeit.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-166">Traffic Manager also provides high availability and responsiveness.</span></span> <span data-ttu-id="d4f2f-167">Die Anwendungsendpunkte müssen extern zugänglich sein.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-167">The application endpoints must be accessible from the outside.</span></span> <span data-ttu-id="d4f2f-168">Hierfür sind auch andere lokale Lösungen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-168">There are other on-premises solutions available as well.</span></span>

<span data-ttu-id="d4f2f-169">Über den **Kubernetes-Eingangsdatencontroller** werden HTTP(S)-Routen für die Dienste in einem Kubernetes-Cluster verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-169">**Kubernetes Ingress Controller** exposes HTTP(S) routes to services in a Kubernetes cluster.</span></span> <span data-ttu-id="d4f2f-170">Zu diesem Zweck können NGINX oder andere geeignete Eingangsdatencontroller verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-170">Nginx or any suitable ingress controller can be used for this purpose.</span></span>

<span data-ttu-id="d4f2f-171">**Helm** ist ein Paket-Manager für die Kubernetes-Bereitstellung, mit dem unterschiedliche Kubernetes-Objekte, z. B. Bereitstellungen, Dienste, Geheimnisse, in einem gemeinsamen „Diagramm“ zusammengestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-171">**Helm** is a package manager for Kubernetes deployment, providing a way to bundle different Kubernetes objects like Deployments, Services, Secrets, into a single "chart".</span></span> <span data-ttu-id="d4f2f-172">Sie können die Versionsverwaltung veröffentlichen, bereitstellen und steuern und ein Diagrammobjekt aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-172">You can publish, deploy, control version management, and update a chart  object.</span></span> <span data-ttu-id="d4f2f-173">Azure Container Registry kann als Repository zum Speichern von Paketen mit Helm-Diagrammen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-173">Azure Container Registry can be used as a repository to store packaged Helm Charts.</span></span>

## <a name="design-considerations"></a><span data-ttu-id="d4f2f-174">Überlegungen zum Entwurf</span><span class="sxs-lookup"><span data-stu-id="d4f2f-174">Design considerations</span></span>

<span data-ttu-id="d4f2f-175">Dieses Muster basiert auf einigen allgemeinen Aspekten, die in den nächsten Abschnitten dieses Artikels ausführlicher beschrieben werden:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-175">This pattern follows a few high-level considerations explained in more detail in the next sections of this article:</span></span>

- <span data-ttu-id="d4f2f-176">Für die Anwendung werden native Kubernetes-Lösungen genutzt, um die Abhängigkeit von Anbietern zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-176">The application uses Kubernetes-native solutions, to avoid vendor lock-in.</span></span>
- <span data-ttu-id="d4f2f-177">Die Anwendung basiert auf einer Microservicearchitektur.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-177">The application uses a microservices architecture.</span></span>
- <span data-ttu-id="d4f2f-178">Für Azure Stack Hub wird keine eingehende Konnektivität benötigt, aber die Internetkonnektivität in ausgehender Richtung ist zulässig.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-178">Azure Stack Hub doesn't need inbound but allows outbound Internet connectivity.</span></span>

<span data-ttu-id="d4f2f-179">Diese empfohlenen Vorgehensweisen gelten auch für reale Workloads und Szenarien.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-179">These recommended practices will apply to real-world workloads and scenarios as well.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="d4f2f-180">Überlegungen zur Skalierbarkeit</span><span class="sxs-lookup"><span data-stu-id="d4f2f-180">Scalability considerations</span></span>

<span data-ttu-id="d4f2f-181">Skalierbarkeit ist wichtig, damit der Zugriff auf die Anwendung für Benutzer einheitlich, zuverlässig und leistungsstark ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-181">Scalability is important to provide users consistent, reliable, and well-performing access to the application.</span></span>

<span data-ttu-id="d4f2f-182">Im Beispielszenario wird die Skalierbarkeit auf mehreren Ebenen des Anwendungsstapels beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-182">The sample scenario covers scalability on multiple layers of the application stack.</span></span> <span data-ttu-id="d4f2f-183">Hier ist eine allgemeine Zusammenfassung der unterschiedlichen Ebenen angegeben:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-183">Here's a high-level overview of the different layers:</span></span>

| <span data-ttu-id="d4f2f-184">Architekturebene</span><span class="sxs-lookup"><span data-stu-id="d4f2f-184">Architecture level</span></span> | <span data-ttu-id="d4f2f-185">Betrifft</span><span class="sxs-lookup"><span data-stu-id="d4f2f-185">Affects</span></span> | <span data-ttu-id="d4f2f-186">Wie kann ich das erreichen?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-186">How?</span></span> |
| --- | --- | ---
| <span data-ttu-id="d4f2f-187">Application</span><span class="sxs-lookup"><span data-stu-id="d4f2f-187">Application</span></span> | <span data-ttu-id="d4f2f-188">Application</span><span class="sxs-lookup"><span data-stu-id="d4f2f-188">Application</span></span> | <span data-ttu-id="d4f2f-189">Horizontale Skalierung basierend auf der Anzahl von Pods/Replikaten/Containerinstanzen\*</span><span class="sxs-lookup"><span data-stu-id="d4f2f-189">Horizontal scaling based on the number of Pods/Replicas/Container Instances\*</span></span> |
| <span data-ttu-id="d4f2f-190">Cluster</span><span class="sxs-lookup"><span data-stu-id="d4f2f-190">Cluster</span></span> | <span data-ttu-id="d4f2f-191">Kubernetes-Cluster</span><span class="sxs-lookup"><span data-stu-id="d4f2f-191">Kubernetes cluster</span></span> | <span data-ttu-id="d4f2f-192">Anzahl von Knoten (zwischen 1 und 50), VM-SKU-Größen und Knotenpools (AKS-Engine unter Azure Stack Hub unterstützt derzeit nicht mehr als einen Knotenpool); Verwendung des Skalierungsbefehls der AKS-Engine (manuell)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-192">Number of Nodes (between 1 and 50), VM-SKU-sizes, and Node Pools (AKS Engine on Azure Stack Hub currently supports only a single node pool); using AKS Engine's scale command (manual)</span></span> |
| <span data-ttu-id="d4f2f-193">Infrastruktur</span><span class="sxs-lookup"><span data-stu-id="d4f2f-193">Infrastructure</span></span> | <span data-ttu-id="d4f2f-194">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-194">Azure Stack Hub</span></span> | <span data-ttu-id="d4f2f-195">Anzahl von Knoten, Kapazität und Skalierungseinheiten einer Azure Stack Hub-Bereitstellung</span><span class="sxs-lookup"><span data-stu-id="d4f2f-195">Number of nodes, capacity, and scale units within an Azure Stack Hub deployment</span></span> |

<span data-ttu-id="d4f2f-196">\* Verwendung der horizontalen automatischen Podskalierung (HPA) von Kubernetes; automatisierte metrikbasierte Skalierung oder vertikale Skalierung durch entsprechende Dimensionierung der Containerinstanzen (CPU/Arbeitsspeicher).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-196">\* Using Kubernetes' Horizontal Pod Autoscaler (HPA); automated metric-based scaling or vertical scaling by sizing the container instances (cpu/memory).</span></span>

<span data-ttu-id="d4f2f-197">**Azure Stack Hub (Infrastrukturebene)**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-197">**Azure Stack Hub (infrastructure level)**</span></span>

<span data-ttu-id="d4f2f-198">Die Azure Stack Hub-Infrastruktur stellt die Grundlage dieser Implementierung dar, weil Azure Stack Hub auf physischer Hardware in einem Rechenzentrum ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-198">The Azure Stack Hub infrastructure is the foundation of this implementation, because Azure Stack Hub runs on physical hardware in a datacenter.</span></span> <span data-ttu-id="d4f2f-199">Bei der Auswahl der Hardware für Ihren Hub müssen Sie Entscheidungen in Bezug auf die CPU, Arbeitsspeicherdichte, Speicherkonfiguration und Anzahl von Servern treffen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-199">When selecting your Hub hardware, you need to make choices for CPU, memory density, storage configuration, and number of servers.</span></span> <span data-ttu-id="d4f2f-200">Weitere Informationen zur Skalierbarkeit von Azure Stack Hub finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-200">To learn more about Azure Stack Hub's scalability, check out the following resources:</span></span>

- [<span data-ttu-id="d4f2f-201">Übersicht über die Kapazitätsplanung für Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-201">Capacity planning for Azure Stack Hub overview</span></span>](/azure-stack/operator/azure-stack-capacity-planning-overview)
- [<span data-ttu-id="d4f2f-202">Hinzufügen zusätzlicher Knoten einer Skalierungseinheit in Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-202">Add additional scale unit nodes in Azure Stack Hub</span></span>](/azure-stack/operator/azure-stack-add-scale-node)

<span data-ttu-id="d4f2f-203">**Kubernetes-Cluster (Clusterebene)**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-203">**Kubernetes cluster (cluster level)**</span></span>

<span data-ttu-id="d4f2f-204">Der Kubernetes-Cluster selbst besteht aus und basiert auf Azure-/Azure Stack-IaaS-Komponenten, z. B. Compute-, Speicher- und Netzwerkressourcen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-204">The Kubernetes cluster itself consists of, and is built on top of Azure (Stack) IaaS components including compute, storage, and network resources.</span></span> <span data-ttu-id="d4f2f-205">Kubernetes-Lösungen verfügen über Master- und Workerknoten, die als VMs in Azure (und Azure Stack Hub) bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-205">Kubernetes solutions involve master and worker nodes, which are deployed as VMs in Azure (and Azure Stack Hub).</span></span>

- <span data-ttu-id="d4f2f-206">Über [Knoten auf Steuerungsebene](/azure/aks/concepts-clusters-workloads#control-plane) (Master) werden die grundlegenden Kubernetes-Dienste und Orchestrierungsfunktionen für Anwendungsworkloads bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-206">[Control plane nodes](/azure/aks/concepts-clusters-workloads#control-plane) (master) provide the core Kubernetes services and orchestration of application workloads.</span></span>
- <span data-ttu-id="d4f2f-207">Auf [Workerknoten](/azure/aks/concepts-clusters-workloads#nodes-and-node-pools) (Worker) werden Ihre Anwendungsworkloads ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-207">[Worker nodes](/azure/aks/concepts-clusters-workloads#nodes-and-node-pools) (worker) run your application workloads.</span></span>

<span data-ttu-id="d4f2f-208">Beim Auswählen von VM-Größen für die erste Bereitstellung sollten die folgenden Aspekte berücksichtigt werden:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-208">When selecting VM sizes for the initial deployment, there are several considerations:</span></span>  

- <span data-ttu-id="d4f2f-209">**Kosten**: Achten Sie beim Planen Ihrer Workerknoten auf die anfallenden Gesamtkosten pro VM.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-209">**Cost** - When planning your worker nodes, keep in mind the overall cost per VM you'll incur.</span></span> <span data-ttu-id="d4f2f-210">Falls für Ihre Anwendungsworkloads beispielsweise eingeschränkte Ressourcen benötigt werden, sollten Sie die Bereitstellung von virtuellen Computern mit geringerer Größe planen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-210">For example, if your application workloads require limited resources, you should plan to deploy smaller sized VMs.</span></span> <span data-ttu-id="d4f2f-211">Die Abrechnung für Azure Stack Hub erfolgt – wie für Azure auch – normalerweise auf Nutzungsbasis. Die richtige Dimensionierung der VMs für Kubernetes-Rollen ist daher von entscheidender Bedeutung, um die Kosten für die Nutzung zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-211">Azure Stack Hub, like Azure, is normally billed on a consumption basis, so appropriately sizing the VMs for Kubernetes roles is crucial to optimizing consumption costs.</span></span> 

- <span data-ttu-id="d4f2f-212">**Skalierbarkeit**: Der Cluster wird skaliert, indem die Anzahl von Master- und Workerknoten ab- und aufskaliert wird oder indem weitere Knotenpools hinzugefügt werden (derzeit in Azure Stack Hub nicht verfügbar).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-212">**Scalability** - Scalability of the cluster is achieved by scaling in and out the number of master and worker nodes, or by adding additional node pools (not available on Azure Stack Hub today).</span></span> <span data-ttu-id="d4f2f-213">Die Skalierung des Clusters kann basierend auf Leistungsdaten erfolgen, die mit Container Insights (Azure Monitor und Log Analytics) gesammelt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-213">Scaling the cluster can be done based on performance data, collected using Container Insights (Azure Monitor + Log Analytics).</span></span> 

    <span data-ttu-id="d4f2f-214">Falls für Ihre Anwendung mehr (oder weniger) Ressourcen benötigt werden, können Sie für Ihre aktuellen Knoten das Aufskalieren (oder Abskalieren) durchführen (im Bereich von 1 bis 50 Knoten).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-214">If your application needs more (or fewer) resources, you can scale out (or in) your current nodes horizontally (between 1 and 50 nodes).</span></span> <span data-ttu-id="d4f2f-215">Falls Sie mehr als 50 Knoten benötigen, können Sie einen zusätzlichen Cluster unter einem separaten Abonnement erstellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-215">If you need more than 50 nodes, you can create an additional cluster in a separate subscription.</span></span> <span data-ttu-id="d4f2f-216">Das Hochskalieren der eigentlichen VMs auf eine andere VM-Größe ohne erneute Bereitstellung des Clusters ist nicht möglich.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-216">You can't scale up the actual VMs vertically to another VM size without redeploying the cluster.</span></span>

    <span data-ttu-id="d4f2f-217">Die Skalierung wird manuell mit dem virtuellen Hilfscomputer der AKS-Engine durchgeführt, der für die anfängliche Bereitstellung des Kubernetes-Clusters verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-217">Scaling is done manually using the AKS Engine helper VM that was used to deploy the Kubernetes cluster initially.</span></span> <span data-ttu-id="d4f2f-218">Weitere Informationen finden Sie im Artikel zum [Skalieren von Kubernetes-Clustern](https://github.com/Azure/aks-engine/blob/master/docs/topics/scale.md).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-218">For more information, see [Scaling Kubernetes clusters](https://github.com/Azure/aks-engine/blob/master/docs/topics/scale.md)</span></span>

- <span data-ttu-id="d4f2f-219">**Kontingente**: Berücksichtigen Sie die von Ihnen konfigurierten [Kontingente](/azure-stack/operator/azure-stack-quota-types), wenn Sie eine AKS-Bereitstellung für Ihre Azure Stack Hub-Instanz planen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-219">**Quotas** - Consider the [quotas](/azure-stack/operator/azure-stack-quota-types) you've configured when planning out an AKS deployment on your Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-220">Stellen Sie sicher, dass für jedes [Abonnement](/azure-stack/operator/service-plan-offer-subscription-overview) die richtigen Pläne und Kontingente konfiguriert wurden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-220">Make sure each [subscription](/azure-stack/operator/service-plan-offer-subscription-overview) has the proper plans and the quotas configured.</span></span> <span data-ttu-id="d4f2f-221">Das Abonnement muss für den Umfang der Compute-, Speicher- und anderen Dienste ausgelegt sein, die für Ihre Cluster beim Aufskalieren benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-221">The subscription will need to accommodate the amount of compute, storage, and other services needed for your clusters as they scale out.</span></span>

- <span data-ttu-id="d4f2f-222">**Anwendungsworkloads**: Informieren Sie sich im Artikel „Grundlegende Kubernetes-Konzepte für Azure Kubernetes Service (AKS)“ über die [Cluster- und Workloadkonzepte](/azure/aks/concepts-clusters-workloads#nodes-and-node-pools).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-222">**Application workloads** - Refer to the [Clusters and workloads concepts](/azure/aks/concepts-clusters-workloads#nodes-and-node-pools) in the Kubernetes core concepts for Azure Kubernetes Service document.</span></span> <span data-ttu-id="d4f2f-223">Dieser Artikel enthält hilfreiche Informationen zum Auswählen der richtigen VM-Größe basierend auf den Compute- und Arbeitsspeicheranforderungen Ihrer Anwendung.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-223">This article will help you scope the proper VM size based on the compute and memory needs of your application.</span></span>  

<span data-ttu-id="d4f2f-224">**Anwendung (Anwendungsebene)**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-224">**Application (application level)**</span></span>

<span data-ttu-id="d4f2f-225">Auf der Anwendungsebene verwenden wir die [horizontale automatische Podskalierung (Horizontal Pod Autoscaler, HPA)](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/) von Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-225">On the application layer, we use Kubernetes [Horizontal Pod Autoscaler (HPA)](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/).</span></span> <span data-ttu-id="d4f2f-226">Mit dieser Skalierung kann die Anzahl von Replikaten (Pod-/Containerinstanzen) in unserer Bereitstellung basierend auf unterschiedlichen Metriken (z. B. CPU-Auslastung) erhöht oder verringert werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-226">HPA can increase or decrease the number of Replicas (Pod/Container Instances) in our deployment based on different metrics (like CPU utilization).</span></span>

<span data-ttu-id="d4f2f-227">Eine andere Möglichkeit ist die vertikale Skalierung von Containerinstanzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-227">Another option is to scale container instances vertically.</span></span> <span data-ttu-id="d4f2f-228">Dies kann erreicht werden, indem Sie die CPU- und Arbeitsspeichermenge ändern, die für eine bestimmte Bereitstellung angefordert wurde und verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-228">This can be accomplished by changing the amount of CPU and Memory requested and available for a specific deployment.</span></span> <span data-ttu-id="d4f2f-229">Weitere Informationen finden Sie unter „kubernetes.io“ im Artikel zum [Verwalten von Ressourcen für Container](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-229">See [Managing Resources for Containers](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/) on kubernetes.io to learn more.</span></span>

## <a name="networking-and-connectivity-considerations"></a><span data-ttu-id="d4f2f-230">Überlegungen zu Netzwerk und Konnektivität</span><span class="sxs-lookup"><span data-stu-id="d4f2f-230">Networking and connectivity considerations</span></span>

<span data-ttu-id="d4f2f-231">Das Netzwerk und die Konnektivität wirken sich ebenfalls auf die oben erwähnten drei Ebenen für Kubernetes unter Azure Stack Hub aus.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-231">Networking and connectivity also affect the three layers mentioned previously for Kubernetes on Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-232">In der folgenden Tabelle sind die Ebenen und die darin enthaltenen Dienste aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-232">The following table shows the layers and which services they contain:</span></span>

| <span data-ttu-id="d4f2f-233">Ebene</span><span class="sxs-lookup"><span data-stu-id="d4f2f-233">Layer</span></span> | <span data-ttu-id="d4f2f-234">Betrifft</span><span class="sxs-lookup"><span data-stu-id="d4f2f-234">Affects</span></span> | <span data-ttu-id="d4f2f-235">Was?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-235">What?</span></span> |
| --- | --- | ---
| <span data-ttu-id="d4f2f-236">Application</span><span class="sxs-lookup"><span data-stu-id="d4f2f-236">Application</span></span> | <span data-ttu-id="d4f2f-237">Application</span><span class="sxs-lookup"><span data-stu-id="d4f2f-237">Application</span></span> | <span data-ttu-id="d4f2f-238">Wie kann auf die Anwendung zugegriffen werden?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-238">How is the application accessible?</span></span> <span data-ttu-id="d4f2f-239">Wird sie für den Zugriff über das Internet verfügbar gemacht?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-239">Will it be exposed to the Internet?</span></span> |
| <span data-ttu-id="d4f2f-240">Cluster</span><span class="sxs-lookup"><span data-stu-id="d4f2f-240">Cluster</span></span> | <span data-ttu-id="d4f2f-241">Kubernetes-Cluster</span><span class="sxs-lookup"><span data-stu-id="d4f2f-241">Kubernetes cluster</span></span> | <span data-ttu-id="d4f2f-242">Kubernetes-API, AKS-Engine-VM, Pullen von Containerimages (ausgehend), Senden von Überwachungs- und Telemetriedaten (ausgehend)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-242">Kubernetes API, AKS Engine VM, Pulling container images (egress), Sending monitoring data and telemetry (egress)</span></span> |
| <span data-ttu-id="d4f2f-243">Infrastruktur</span><span class="sxs-lookup"><span data-stu-id="d4f2f-243">Infrastructure</span></span> | <span data-ttu-id="d4f2f-244">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-244">Azure Stack Hub</span></span> | <span data-ttu-id="d4f2f-245">Zugänglichkeit der Azure Stack Hub-Verwaltungsendpunkte, z. B. Portal und Azure Resource Manager-Endpunkte</span><span class="sxs-lookup"><span data-stu-id="d4f2f-245">Accessibility of the Azure Stack Hub management endpoints like the portal and Azure Resource Manager endpoints.</span></span> |

<span data-ttu-id="d4f2f-246">**Anwendung**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-246">**Application**</span></span>

<span data-ttu-id="d4f2f-247">Der wichtigste Aspekt für die Anwendungsebene ist, ob die Anwendung über das Internet verfügbar gemacht wird bzw. zugänglich ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-247">For the application layer, the most important consideration is whether the application is exposed and accessible from the Internet.</span></span> <span data-ttu-id="d4f2f-248">Aus Sicht von Kubernetes bedeutet die Zugänglichkeit über das Internet, dass eine Bereitstellung oder ein Pod über einen Kubernetes-Dienst oder einen Eingangsdatencontroller verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-248">From a Kubernetes perspective, Internet accessibility means exposing a deployment or pod using a Kubernetes Service or an Ingress Controller.</span></span>

> [!NOTE]
> <span data-ttu-id="d4f2f-249">Wir empfehlen Ihnen die Verwendung eines Eingangsdatencontrollers, um Kubernetes-Dienste verfügbar zu machen, da die Anzahl von öffentlichen Front-End-IP-Adressen unter Azure Stack Hub auf 5 beschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-249">We recommend the use of Ingress controllers to expose Kubernetes Services as the number of Frontend public IPs on Azure Stack Hub is limited to 5.</span></span> <span data-ttu-id="d4f2f-250">Aus diesem Grund ist auch die Anzahl von Kubernetes-Diensten (vom Typ „LoadBalancer“) auf 5 beschränkt, und dies kann für viele Bereitstellungen ggf. nicht ausreichen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-250">This design also limits the number of Kubernetes Services (with the type LoadBalancer) to 5, which will be too small for many deployments.</span></span> <span data-ttu-id="d4f2f-251">Weitere Informationen finden Sie in der [Dokumentation zur AKS-Engine](https://github.com/Azure/aks-engine/blob/master/docs/topics/azure-stack.md#limited-number-of-frontend-public-ips).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-251">Go to the [AKS Engine documentation](https://github.com/Azure/aks-engine/blob/master/docs/topics/azure-stack.md#limited-number-of-frontend-public-ips) to learn more.</span></span>

<span data-ttu-id="d4f2f-252">Das Verfügbarmachen einer Anwendung mit einer öffentlichen IP-Adresse über einen Load Balancer oder einen Eingangsdatencontroller bedeutet nicht zwangsläufig, dass die Anwendung sofort über das Internet zugänglich ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-252">Exposing an application using a public IP via a Load Balancer or an Ingress Controller doesn't nessecarily mean that the application is now accessible via the Internet.</span></span> <span data-ttu-id="d4f2f-253">In Azure Stack Hub kann eine öffentliche IP-Adresse auch nur im lokalen Intranet sichtbar sein. Nicht alle öffentlichen IP-Adressen sind auch wirklich über das Internet erreichbar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-253">It's possible for Azure Stack Hub to have a public IP address that is only visible on the local intranet - not all public IPs are truly Internet-facing.</span></span>

<span data-ttu-id="d4f2f-254">Im obigen Abschnitt wurde der eingehende Datenverkehr für die Anwendung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-254">The previous block considers ingress traffic to the application.</span></span> <span data-ttu-id="d4f2f-255">Ein weiteres Thema, das bei der Sicherstellung einer erfolgreichen Kubernetes-Bereitstellung berücksichtigt werden muss, ist ausgehender Datenverkehr.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-255">Another topic that must be considered for a successful Kubernetes deployment is outbound/egress traffic.</span></span> <span data-ttu-id="d4f2f-256">Hier sind einige Anwendungsfälle angegeben, für die ausgehender Datenverkehr erforderlich ist:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-256">Here are a few use cases that require egress traffic:</span></span>

- <span data-ttu-id="d4f2f-257">Pullen von Containerimages, die in Docker Hub oder Azure Container Registry gespeichert sind</span><span class="sxs-lookup"><span data-stu-id="d4f2f-257">Pulling Container Images stored on DockerHub or Azure Container Registry</span></span>
- <span data-ttu-id="d4f2f-258">Abrufen von Helm-Diagrammen</span><span class="sxs-lookup"><span data-stu-id="d4f2f-258">Retrieving Helm Charts</span></span>
- <span data-ttu-id="d4f2f-259">Ausgeben von Application Insights-Daten (oder anderer Überwachungsdaten)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-259">Emitting Application Insights data (or other monitoring data)</span></span>

<span data-ttu-id="d4f2f-260">Für einige Unternehmensumgebungen werden unter Umständen _transparente_ oder _nicht transparente_ Proxyserver benötigt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-260">Some enterprise environments might require the use of _transparent_ or _non-transparent_ proxy servers.</span></span> <span data-ttu-id="d4f2f-261">Für diese Server ist eine bestimmte Konfiguration auf verschiedenen Komponenten unseres Clusters erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-261">These servers require specific configuration on various components of our cluster.</span></span> <span data-ttu-id="d4f2f-262">Die Dokumentation zur AKS-Engine enthält verschiedene Details zu Netzwerkproxys.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-262">The AKS Engine documentation contains various details on how to accommodate network proxies.</span></span> <span data-ttu-id="d4f2f-263">Ausführliche Informationen hierzu finden Sie im Artikel zur [AKS-Engine und zu Proxyservern](https://github.com/Azure/aks-engine/blob/master/docs/topics/proxy-servers.md).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-263">For more details, see [AKS Engine and proxy servers](https://github.com/Azure/aks-engine/blob/master/docs/topics/proxy-servers.md)</span></span>

<span data-ttu-id="d4f2f-264">Schließlich gibt es noch die Anforderung, dass der Fluss von clusterübergreifendem Datenverkehr zwischen Azure Stack Hub-Instanzen möglich sein muss.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-264">Lastly, cross-cluster traffic must flow between Azure Stack Hub instances.</span></span> <span data-ttu-id="d4f2f-265">Die Beispielbereitstellung enthält individuelle Kubernetes-Cluster, die auf einzelnen Azure Stack Hub-Instanzen ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-265">The sample deployment consists of individual Kubernetes clusters running on individual Azure Stack Hub instances.</span></span> <span data-ttu-id="d4f2f-266">Der Datenverkehr, der zwischen diesen Komponenten fließt, z. B. Replikationsdatenverkehr zwischen zwei Datenbanken, ist „extern“.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-266">Traffic between them, such as the replication traffic between two databases, is "external traffic".</span></span> <span data-ttu-id="d4f2f-267">Externer Datenverkehr muss entweder über eine Site-to-Site-VPN-Verbindung oder öffentliche Azure Stack Hub-IP-Adressen weitergeleitet werden, um für Kubernetes auf zwei Azure Stack Hub-Instanzen eine Verbindung herzustellen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-267">External traffic must be routed through either a Site-to-Site VPN or Azure Stack Hub Public IP addresses to connect Kubernetes on two Azure Stack Hub instances:</span></span>

![Datenverkehr in einem Cluster und zwischen mehreren Clustern](media/pattern-highly-available-kubernetes/aks-inter-and-intra-cluster-traffic.png)

<span data-ttu-id="d4f2f-269">**Cluster**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-269">**Cluster**</span></span>  

<span data-ttu-id="d4f2f-270">Der Kubernetes-Cluster muss nicht unbedingt über das Internet zugänglich sein.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-270">The Kubernetes cluster doesn't necessarily need to be accessible via the Internet.</span></span> <span data-ttu-id="d4f2f-271">Der relevante Teil ist die Kubernetes-API, die zum Betreiben eines Clusters verwendet wird, z. B. mit `kubectl`.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-271">The relevant part is the Kubernetes API used to operate a cluster, for example, using `kubectl`.</span></span> <span data-ttu-id="d4f2f-272">Der Kubernetes-API-Endpunkt muss für alle Benutzer zugänglich sein, von denen der Cluster betrieben wird oder die Anwendungen und die zugehörigen Dienste bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-272">The Kubernetes API endpoint must be accessible to everyone who operates the cluster or deploys applications and services on top of it.</span></span> <span data-ttu-id="d4f2f-273">Dieses Thema wird unten im Abschnitt [Bereitstellungsaspekte (CI/CD)](#deployment-cicd-considerations) aus DevOps-Sicht ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-273">This topic is covered in more detail from a DevOps-perspective in the [Deployment (CI/CD) considerations](#deployment-cicd-considerations) section below.</span></span>

<span data-ttu-id="d4f2f-274">Auf der Clusterebene sollten auch einige Aspekte in Bezug auf ausgehenden Datenverkehr berücksichtigt werden:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-274">On the cluster level, there are also a few considerations around egress-traffic:</span></span>

- <span data-ttu-id="d4f2f-275">Updates für Knoten (für Ubuntu)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-275">Node updates (for Ubuntu)</span></span>
- <span data-ttu-id="d4f2f-276">Überwachungsdaten (an Azure Log Analytics gesendet)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-276">Monitoring data (sent to Azure LogAnalytics)</span></span>
- <span data-ttu-id="d4f2f-277">Andere Agents, für die ausgehender Datenverkehr erforderlich ist (je nach Umgebung der einzelnen Bereitsteller)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-277">Other agents requiring outbound traffic (specific to each deployer's environment)</span></span>

<span data-ttu-id="d4f2f-278">Bevor Sie Ihren Kubernetes-Cluster mit einer AKS-Engine bereitstellen, sollten Sie den endgültigen Netzwerkentwurf planen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-278">Before you deploy your Kubernetes cluster using AKS Engine, plan for the final networking design.</span></span> <span data-ttu-id="d4f2f-279">Anstatt ein dediziertes virtuelles Netzwerk zu erstellen, kann es effizienter sein, einen Cluster in einem vorhandenen Netzwerk bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-279">Instead of creating a dedicated Virtual Network, it may be more efficient to deploy a cluster into an existing network.</span></span> <span data-ttu-id="d4f2f-280">Beispielsweise können Sie ggf. eine vorhandene Site-to-Site-VPN-Verbindung nutzen, die in Ihrer Azure Stack Hub-Umgebung bereits konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-280">For example, you might leverage an existing Site-to-Site VPN connection already configured in your Azure Stack Hub environment.</span></span>

<span data-ttu-id="d4f2f-281">**Infrastruktur**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-281">**Infrastructure**</span></span>  

<span data-ttu-id="d4f2f-282">Bei der Infrastruktur geht es um den Zugriff auf die Azure Stack Hub-Verwaltungsendpunkte.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-282">Infrastructure refers to accessing the Azure Stack Hub management endpoints.</span></span> <span data-ttu-id="d4f2f-283">Zu den Endpunkten gehören die Mandanten- und Administratorportale sowie die Azure Resource Manager-Endpunkte für Administratoren und Mandanten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-283">Endpoints include the tenant and admin portals, and the Azure Resource Manager admin and tenant endpoints.</span></span> <span data-ttu-id="d4f2f-284">Diese Endpunkte werden zum Betreiben von Azure Stack Hub und der zugehörigen Kerndienste benötigt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-284">These endpoints are required to operate Azure Stack Hub and its core services.</span></span>

## <a name="data-and-storage-considerations"></a><span data-ttu-id="d4f2f-285">Überlegungen zu Daten und Speicher</span><span class="sxs-lookup"><span data-stu-id="d4f2f-285">Data and storage considerations</span></span>

<span data-ttu-id="d4f2f-286">Zwei Instanzen unserer Anwendung werden in zwei einzelnen Kubernetes-Clustern auf zwei Azure Stack Hub-Instanzen bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-286">Two instances of our application will be deployed, on two individual Kubernetes clusters, across two Azure Stack Hub instances.</span></span> <span data-ttu-id="d4f2f-287">Bei diesem Entwurf müssen wir berücksichtigen, wie Daten zwischen den einzelnen Komponenten repliziert und synchronisiert werden sollen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-287">This design will require us to consider how to replicate and synchronize data between them.</span></span>

<span data-ttu-id="d4f2f-288">Mit Azure verfügen wir über eine integrierte Funktion zum übergreifenden Replizieren von Speicher in mehreren Regionen und Zonen in der Cloud.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-288">With Azure, we have the built-in capability to replicate storage across multiple regions and zones within the cloud.</span></span> <span data-ttu-id="d4f2f-289">Für Azure Stack Hub gibt es derzeit keine native Möglichkeit zum Replizieren von Speicher auf zwei unterschiedlichen Azure Stack Hub-Instanzen. Diese Instanzen stellen zwei unabhängige Clouds ohne allgemeine Option für die gemeinsame Verwaltung dar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-289">Currently with Azure Stack Hub there are no native ways to replicate storage across two different Azure Stack Hub instances - they form two independent clouds with no overarching way to manage them as a set.</span></span> <span data-ttu-id="d4f2f-290">Bei der Auslegung von Anwendungen unter Azure Stack Hub auf Resilienz sollten Sie diese Unabhängigkeit in Ihrem Anwendungsentwurf und für die Bereitstellungen beachten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-290">Planning for resiliency of applications running across Azure Stack Hub forces you to consider this independence in your application design and deployments.</span></span>

<span data-ttu-id="d4f2f-291">In den meisten Fällen ist die Speicherreplikation zur Erzielung einer resilienten und hoch verfügbaren Anwendung, die unter AKS bereitgestellt wird, nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-291">In most cases, storage replication won't be necessary for a resilient and highly available application deployed on AKS.</span></span> <span data-ttu-id="d4f2f-292">In Ihrem Anwendungsentwurf sollten Sie die unabhängige Speicherung für jede Azure Stack Hub-Instanz aber berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-292">But you should consider independent storage per Azure Stack Hub instance in your application design.</span></span> <span data-ttu-id="d4f2f-293">Falls diese Art von Entwurf für Sie problematisch ist oder die Bereitstellung der Lösung unter Azure Stack Hub verhindert, können Sie Lösungen von Microsoft-Partnern in Anspruch nehmen, mit denen Speicher angefügt werden kann.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-293">If this design is a concern or road block to deploying the solution on Azure Stack Hub, there are possible solutions from Microsoft Partners that provide storage attachments.</span></span> <span data-ttu-id="d4f2f-294">Das Anfügen von Speicher stellt eine Lösung für die übergreifende Speicherreplikation auf mehreren Azure Stack Hub-Instanzen und in Azure dar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-294">Storage attachments provide a storage replication solution across multiple Azure Stack Hubs and Azure.</span></span> <span data-ttu-id="d4f2f-295">Weitere Informationen finden Sie im Abschnitt zu den [Partnerlösungen](#partner-solutions).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-295">For more information, see the [Partner solutions](#partner-solutions).</span></span>

<span data-ttu-id="d4f2f-296">Für unsere Architektur wurden die folgenden Ebenen berücksichtigt:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-296">In our architecture, these layers were considered:</span></span>

<span data-ttu-id="d4f2f-297">**Configuration**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-297">**Configuration**</span></span>

<span data-ttu-id="d4f2f-298">Umfasst die Konfiguration von Azure Stack Hub, der AKS-Engine und des eigentlichen Kubernetes-Clusters.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-298">Configuration includes the configuration of Azure Stack Hub, AKS Engine, and the Kubernetes cluster itself.</span></span> <span data-ttu-id="d4f2f-299">Die Konfiguration sollte so weit wie möglich automatisiert und im Infrastructure-as-Code-Format in einem Git-basierten Versionskontrollsystem wie Azure DevOps oder GitHub gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-299">The configuration should be automated as much as possible, and stored as Infrastructure-as-Code in a Git-based version control system like Azure DevOps or GitHub.</span></span> <span data-ttu-id="d4f2f-300">Diese Einstellungen können nicht ohne größeren Aufwand für mehrere Bereitstellungen synchronisiert werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-300">These settings cannot easily be synchronized across multiple deployments.</span></span> <span data-ttu-id="d4f2f-301">Daher empfehlen wir Ihnen, die Konfiguration extern zu speichern und anzuwenden und eine DevOps-Pipeline zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-301">Therefore we recommend storing and applying configuration from the outside, and using DevOps pipeline.</span></span>

<span data-ttu-id="d4f2f-302">**Anwendung**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-302">**Application**</span></span>

<span data-ttu-id="d4f2f-303">Die Anwendung sollte in einem Git-basierten Repository gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-303">The application should be stored in a Git-based repository.</span></span> <span data-ttu-id="d4f2f-304">Bei einer neuen Bereitstellung, bei Änderungen der Anwendung oder bei einer Notfallwiederherstellung kann die Bereitstellung mit Azure Pipelines dann leicht durchgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-304">Whenever there's a new deployment, changes to the application, or disaster recovery, it can be easily deployed using Azure Pipelines.</span></span>

<span data-ttu-id="d4f2f-305">**Daten**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-305">**Data**</span></span>

<span data-ttu-id="d4f2f-306">Daten sind bei den meisten Anwendungsentwürfen der wichtigste Aspekt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-306">Data is the most important consideration in most application designs.</span></span> <span data-ttu-id="d4f2f-307">Anwendungsdaten müssen zwischen den verschiedenen Instanzen der Anwendung immer synchron gehalten werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-307">Application data must stay in sync between the different instances of the application.</span></span> <span data-ttu-id="d4f2f-308">Darüber hinaus ist für Daten auch eine Strategie für die Sicherung und die Notfallwiederherstellung erforderlich, falls es zu einem Ausfall kommt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-308">Data also needs a backup and disaster recovery strategy if there's an outage.</span></span>

<span data-ttu-id="d4f2f-309">Die Umsetzung dieses Entwurfs hängt stark von der gewählten Technologie ab.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-309">Achieving this design depends heavily on technology choices.</span></span> <span data-ttu-id="d4f2f-310">Hier sind einige Lösungsbeispiele für die Implementierung einer Datenbank mit Hochverfügbarkeit unter Azure Stack Hub angegeben:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-310">Here are some solution examples for implementing a database in a highly available fashion on Azure Stack Hub:</span></span>

- [<span data-ttu-id="d4f2f-311">Bereitstellen einer SQL Server 2016-Verfügbarkeitsgruppe in Azure und Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-311">Deploy a SQL Server 2016 availability group to Azure and Azure Stack Hub</span></span>](/azure-stack/hybrid/solution-deployment-guide-sql-ha)
- [<span data-ttu-id="d4f2f-312">Bereitstellen einer MongoDB-Hochverfügbarkeitslösung in Azure und Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-312">Deploy a highly available MongoDB solution to Azure and Azure Stack Hub</span></span>](/azure-stack/hybrid/solution-deployment-guide-mongodb-ha)

<span data-ttu-id="d4f2f-313">Die Überlegungen bei der übergreifenden Nutzung von Daten an mehreren Standorten sind noch umfangreicher, wenn eine hoch verfügbare und resiliente Lösung erzielt werden soll.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-313">Considerations when working with data across multiple locations is an even more complex consideration for a highly available and resilient solution.</span></span> <span data-ttu-id="d4f2f-314">Zu berücksichtigen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-314">Consider:</span></span>

- <span data-ttu-id="d4f2f-315">Latenz und Netzwerkkonnektivität zwischen Azure Stack Hub-Instanzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-315">Latency and network connectivity between Azure Stack Hubs.</span></span>
- <span data-ttu-id="d4f2f-316">Verfügbarkeit von Identitäten für Dienste und Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-316">Availability of identities for services and permissions.</span></span> <span data-ttu-id="d4f2f-317">Jede Azure Stack Hub-Instanz wird in ein externes Verzeichnis integriert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-317">Each Azure Stack Hub instance integrates with an external directory.</span></span> <span data-ttu-id="d4f2f-318">Während der Bereitstellung entscheiden Sie sich entweder für die Verwendung von Azure Active Directory (Azure AD) oder Active Directory-Verbunddienste (AD FS).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-318">During deployment, you choose to use either Azure Active Directory (Azure AD) or Active Directory Federation Services (ADFS).</span></span> <span data-ttu-id="d4f2f-319">Daher besteht die Möglichkeit, nur eine Identität zu verwenden, die mit mehreren unabhängigen Azure Stack Hub-Instanzen interagieren kann.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-319">As such, there's potential to use a single identity that can interact with multiple independent Azure Stack Hub instances.</span></span>

## <a name="business-continuity-and-disaster-recovery"></a><span data-ttu-id="d4f2f-320">Business Continuity & Disaster Recovery</span><span class="sxs-lookup"><span data-stu-id="d4f2f-320">Business continuity and disaster recovery</span></span>

<span data-ttu-id="d4f2f-321">Der Bereich „Business Continuity & Disaster Recovery“ (BCDR), also Geschäftskontinuität und Notfallwiederherstellung, ist sowohl für Azure Stack Hub als auch für Azure ein wichtiges Thema.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-321">Business continuity and disaster recovery (BCDR) is an important topic in both Azure Stack Hub and Azure.</span></span> <span data-ttu-id="d4f2f-322">Der Hauptunterschied besteht darin, dass bei Azure Stack Hub der gesamte BCDR-Prozess vom Operator verwaltet werden muss.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-322">The main difference is that in Azure Stack Hub, the operator must manage the whole BCDR process.</span></span> <span data-ttu-id="d4f2f-323">In Azure werden Teile von BCDR automatisch von Microsoft verwaltet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-323">In Azure, parts of BCDR are automatically managed by Microsoft.</span></span>

<span data-ttu-id="d4f2f-324">BCDR wirkt sich auf dieselben Bereiche aus, die im vorherigen Abschnitt [Überlegungen zu Daten und Speicher](#data-and-storage-considerations) beschrieben wurden:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-324">BCDR affects the same areas mentioned in the previous section [Data and storage considerations](#data-and-storage-considerations):</span></span>

- <span data-ttu-id="d4f2f-325">Infrastruktur/Konfiguration</span><span class="sxs-lookup"><span data-stu-id="d4f2f-325">Infrastructure / Configuration</span></span>
- <span data-ttu-id="d4f2f-326">Anwendungsverfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="d4f2f-326">Application Availability</span></span>
- <span data-ttu-id="d4f2f-327">Anwendungsdaten</span><span class="sxs-lookup"><span data-stu-id="d4f2f-327">Application Data</span></span>

<span data-ttu-id="d4f2f-328">Wie bereits im vorherigen Abschnitt erwähnt, ist der Azure Stack Hub-Operator für diese Bereiche verantwortlich, und die Einzelheiten können von Organisation zu Organisation variieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-328">And as mentioned in the previous section, these areas are the responsibility of the Azure Stack Hub operator and can vary between organizations.</span></span> <span data-ttu-id="d4f2f-329">Führen Sie die Planung für BCDR gemäß Ihren verfügbaren Tools und Prozessen durch.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-329">Plan BCDR according to your available tools and processes.</span></span>

<span data-ttu-id="d4f2f-330">**Infrastruktur und Konfiguration**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-330">**Infrastructure and configuration**</span></span>

<span data-ttu-id="d4f2f-331">In diesem Abschnitt werden die physische und logische Infrastruktur und die Konfiguration von Azure Stack Hub beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-331">This section covers the physical and logical infrastructure and the configuration of Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-332">Es geht um Aktionen für Administratoren und Mandanten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-332">It covers actions in the admin and the tenant spaces.</span></span>

<span data-ttu-id="d4f2f-333">Der Operator (oder Administrator) von Azure Stack Hub ist für die Wartung der Azure Stack Hub-Instanzen verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-333">The Azure Stack Hub operator (or administrator) is responsible for maintenance of the Azure Stack Hub instances.</span></span> <span data-ttu-id="d4f2f-334">Beispiele hierfür sind Komponenten wie Netzwerk, Speicher, Identität und andere Bereiche, deren Erläuterung den Umfang dieses Artikels sprengen würde.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-334">Including components such as the network, storage, identity, and other topics that are outside the scope of this article.</span></span> <span data-ttu-id="d4f2f-335">Weitere Informationen zu den Besonderheiten von Azure Stack Hub-Vorgängen finden Sie in den folgenden Ressourcen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-335">To learn more about the specifics of Azure Stack Hub operations, see the following resources:</span></span>

- [<span data-ttu-id="d4f2f-336">Datenwiederherstellung in Azure Stack Hub mit dem Infrastructure Backup-Dienst</span><span class="sxs-lookup"><span data-stu-id="d4f2f-336">Recover data in Azure Stack Hub with the Infrastructure Backup Service</span></span>](/azure-stack/operator/azure-stack-backup-infrastructure-backup)
- [<span data-ttu-id="d4f2f-337">Aktivieren der Sicherung für Azure Stack Hub über das Administratorportal</span><span class="sxs-lookup"><span data-stu-id="d4f2f-337">Enable backup for Azure Stack Hub from the administrator portal</span></span>](/azure-stack/operator/azure-stack-backup-enable-backup-console)
- [<span data-ttu-id="d4f2f-338">Wiederherstellen nach schwerwiegendem Datenverlust</span><span class="sxs-lookup"><span data-stu-id="d4f2f-338">Recover from catastrophic data loss</span></span>](/azure-stack/operator/azure-stack-backup-recover-data)
- [<span data-ttu-id="d4f2f-339">Bewährte Methoden für den Infrastructure Backup-Dienst</span><span class="sxs-lookup"><span data-stu-id="d4f2f-339">Infrastructure Backup Service best practices</span></span>](/azure-stack/operator/azure-stack-backup-best-practices)

<span data-ttu-id="d4f2f-340">Azure Stack Hub ist die Plattform und das Fabric für die Bereitstellung von Kubernetes-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-340">Azure Stack Hub is the platform and fabric on which Kubernetes applications will be deployed.</span></span> <span data-ttu-id="d4f2f-341">Der Anwendungsbesitzer für die Kubernetes-Anwendung ist ein Benutzer von Azure Stack Hub mit der Zugriffsberechtigung, die zum Bereitstellen der erforderlichen Anwendungsinfrastruktur für die Lösung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-341">The application owner for the Kubernetes application will be a user of Azure Stack Hub, with access granted to deploy the application infrastructure needed for the solution.</span></span> <span data-ttu-id="d4f2f-342">Die Anwendungsinfrastruktur umfasst in diesem Fall den Kubernetes-Cluster, der per AKS-Engine bereitgestellt wurde, und die zugehörigen Dienste.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-342">Application infrastructure in this case means the Kubernetes cluster, deployed using AKS Engine, and the surrounding services.</span></span> <span data-ttu-id="d4f2f-343">Diese Komponenten werden in Azure Stack Hub bereitgestellt und unterliegen den Beschränkungen des jeweiligen Azure Stack Hub-Angebots.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-343">These components will be deployed into Azure Stack Hub, constrained by an Azure Stack Hub offer.</span></span> <span data-ttu-id="d4f2f-344">Stellen Sie sicher, dass das vom Besitzer der Kubernetes-Anwendung akzeptierte Angebot mit ausreichend Kapazität (in Form von Azure Stack Hub-Kontingenten) für die Bereitstellung der gesamten Lösung verbunden ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-344">Make sure the offer accepted by the Kubernetes application owner has sufficient capacity (expressed in Azure Stack Hub quotas) to deploy the entire solution.</span></span> <span data-ttu-id="d4f2f-345">Wie im vorherigen Abschnitt empfohlen, sollte die Anwendungsbereitstellung automatisiert werden, indem Infrastructure-as-Code und Bereitstellungspipelines wie Azure DevOps mit Azure Pipelines genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-345">As recommended in the previous section, the application deployment should be automated using Infrastructure-as-Code and deployment pipelines like Azure DevOps Azure Pipelines.</span></span>

<span data-ttu-id="d4f2f-346">Weitere Informationen zu Azure Stack Hub-Angeboten und -Kontingenten finden Sie unter [Übersicht: Azure Stack Hub-Dienste, -Pläne, -Angebote und Abonnements](/azure-stack/operator/service-plan-offer-subscription-overview).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-346">For more information on Azure Stack Hub offers and quotas, see [Azure Stack Hub services, plans, offers, and subscriptions overview](/azure-stack/operator/service-plan-offer-subscription-overview)</span></span>

<span data-ttu-id="d4f2f-347">Es ist wichtig, die Konfiguration der AKS-Engine, einschließlich der Ausgaben, sicher zu speichern und aufzubewahren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-347">It's important to securely save and store the AKS Engine configuration including its outputs.</span></span> <span data-ttu-id="d4f2f-348">Da diese Dateien vertrauliche Informationen für den Zugriff auf den Kubernetes-Cluster enthalten, müssen sie vor der Offenlegung für unbefugte Benutzer geschützt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-348">These files contain confidential information used to access the Kubernetes cluster, so it must be protected from being exposed to non-administrators.</span></span>

<span data-ttu-id="d4f2f-349">**Anwendungsverfügbarkeit**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-349">**Application availability**</span></span>

<span data-ttu-id="d4f2f-350">Die Anwendung sollte nicht auf Sicherungen einer bereitgestellten Instanz basieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-350">The application shouldn't rely on backups of a deployed instance.</span></span> <span data-ttu-id="d4f2f-351">Gehen Sie standardmäßig so vor, dass Sie die Anwendung anhand von Infrastructure-as-Code-Mustern vollständig neu bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-351">As a standard practice, redeploy the application completely following Infrastructure-as-Code patterns.</span></span> <span data-ttu-id="d4f2f-352">Verwenden Sie für die erneute Bereitstellung beispielsweise Azure DevOps mit Azure Pipelines.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-352">For example, redeploy using Azure DevOps Azure Pipelines.</span></span> <span data-ttu-id="d4f2f-353">Das BCDR-Verfahren sollte die erneute Bereitstellung der Anwendung in demselben oder einem anderen Kubernetes-Cluster beinhalten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-353">The BCDR procedure should involve the redeployment of the application to the same or another Kubernetes cluster.</span></span>

<span data-ttu-id="d4f2f-354">**Anwendungsdaten**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-354">**Application data**</span></span>

<span data-ttu-id="d4f2f-355">Anwendungsdaten sind von entscheidender Bedeutung, wenn es um die Eindämmung von Datenverlusten geht.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-355">Application data is the critical part to minimize data loss.</span></span> <span data-ttu-id="d4f2f-356">Im vorherigen Abschnitt wurden Verfahren zum Replizieren und Synchronisieren von Daten zwischen zwei (oder mehr) Instanzen der Anwendung beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-356">In the previous section, techniques to replicate and synchronize data between two (or more) instances of the application were described.</span></span> <span data-ttu-id="d4f2f-357">Je nach Datenbankinfrastruktur (MySQL, MongoDB, MSSQL oder andere), die zum Speichern der Daten verwendet wird, können Sie zwischen verschiedenen Verfahren zur Sicherstellung der Verfügbarkeit und Sicherung von Datenbanken wählen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-357">Depending on the database infrastructure (MySQL, MongoDB, MSSQL or others) used to store the data, there will be different database availability and backup techniques available to choose from.</span></span>

<span data-ttu-id="d4f2f-358">Zur Erzielung von Integrität wird eine der beiden folgenden Vorgehensweisen empfohlen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-358">The recommended ways to achieve integrity are to use either:</span></span>
- <span data-ttu-id="d4f2f-359">Eine native Sicherungslösung für die jeweilige Datenbank</span><span class="sxs-lookup"><span data-stu-id="d4f2f-359">A native backup solution for the specific database.</span></span>
- <span data-ttu-id="d4f2f-360">Eine Sicherungslösung, von der die Sicherung und Wiederherstellung der Datenbanken, die von Ihrer Anwendung genutzt werden, offiziell unterstützt wird</span><span class="sxs-lookup"><span data-stu-id="d4f2f-360">A backup solution that officially supports backup and recovery of the database type used by your application.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d4f2f-361">Speichern Sie Ihre Sicherungsdaten nicht auf derselben Azure Stack Hub-Instanz, auf der sich Ihre Anwendungsdaten befinden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-361">Do not store your backup data on the same Azure Stack Hub instance where your application data resides.</span></span> <span data-ttu-id="d4f2f-362">Bei einem vollständigen Ausfall der Azure Stack Hub-Instanz würde dies nämlich auch zu einer Kompromittierung Ihrer Sicherungen führen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-362">A complete outage of the Azure Stack Hub instance would also compromise your backups.</span></span>

## <a name="availability-considerations"></a><span data-ttu-id="d4f2f-363">Überlegungen zur Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="d4f2f-363">Availability considerations</span></span>

<span data-ttu-id="d4f2f-364">Bei Kubernetes unter Azure Stack Hub mit Bereitstellung über die AKS-Engine handelt es sich nicht um einen verwalteten Dienst.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-364">Kubernetes on Azure Stack Hub deployed via AKS Engine isn't a managed service.</span></span> <span data-ttu-id="d4f2f-365">Es handelt sich um eine automatisierte Bereitstellung und Konfiguration eines Kubernetes-Clusters per Azure IaaS (Infrastructure-as-a-Service).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-365">It's an automated deployment and configuration of a Kubernetes cluster using Azure Infrastructure-as-a-Service (IaaS).</span></span> <span data-ttu-id="d4f2f-366">Daher wird die gleiche Verfügbarkeit wie für die zugrunde liegende Infrastruktur erzielt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-366">As such, it provides the same availability as the underlying infrastructure.</span></span>

<span data-ttu-id="d4f2f-367">Die Azure Stack Hub-Infrastruktur ist bereits fehlerresistent und verfügt über Funktionen wie Verfügbarkeitsgruppen, um Komponenten auf mehrere [Fehler- und Updatedomänen](/azure-stack/user/azure-stack-vm-considerations#high-availability) verteilen zu können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-367">Azure Stack Hub infrastructure is already resilient to failures, and provides capabilities like Availability Sets to distribute components across multiple [fault and update domains](/azure-stack/user/azure-stack-vm-considerations#high-availability).</span></span> <span data-ttu-id="d4f2f-368">Für die zugrunde liegende Technologie (Failoverclustering) kommt es für die VMs auf einem betroffenen physischen Server aber trotzdem noch zu Downtime, falls ein Hardwarefehler auftritt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-368">But the underlying technology (failover clustering) still incurs some downtime for VMs on an impacted physical server, if there's a hardware failure.</span></span>

<span data-ttu-id="d4f2f-369">Eine bewährte Methode besteht darin, Ihren Kubernetes-Produktionscluster und die Workload in zwei (oder mehr) Clustern bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-369">It's a good practice to deploy your production Kubernetes cluster as well as the workload to two (or more) clusters.</span></span> <span data-ttu-id="d4f2f-370">Diese Cluster sollten an verschiedenen Orten oder in verschiedenen Rechenzentren gehostet werden, und es sollten Lösungen wie Azure Traffic Manager eingesetzt werden, um Benutzer basierend auf der Antwortzeit des Clusters oder auf dem Standort weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-370">These clusters should be hosted in different locations or datacenters, and use technologies like Azure Traffic Manager to route users based on cluster response time or based on geography.</span></span>

![Verwenden von Traffic Manager zum Steuern von Datenverkehrsflüssen](media/pattern-highly-available-kubernetes/aks-azure-traffic-manager.png)

<span data-ttu-id="d4f2f-372">Kunden, die nur einen Kubernetes-Cluster besitzen, stellen in der Regel eine Verbindung mit der Dienst-IP-Adresse oder dem DNS-Namen einer bestimmten Anwendung her.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-372">Customers who have a single Kubernetes cluster typically connect to the service IP or DNS name of a given application.</span></span> <span data-ttu-id="d4f2f-373">In einer Bereitstellung mit mehreren Clustern sollten Kunden eine Verbindung mit dem DNS-Namen der Traffic Manager-Instanz herstellen, die auf die Dienste bzw. den eingehenden Datenverkehr in den einzelnen Kubernetes-Clustern verweist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-373">In a multi-cluster deployment, customers should connect to a Traffic Manager DNS name that points to the services/ingress on each Kubernetes cluster.</span></span>

![Verwenden von Traffic Manager zum Weiterleiten an einen lokalen Cluster](media/pattern-highly-available-kubernetes/aks-azure-traffic-manager-on-premises.png)

> [!NOTE]
> <span data-ttu-id="d4f2f-375">Dieses Muster ist auch eine [bewährte Methode für (verwaltete) AKS-Cluster in Azure](/azure/aks/operator-best-practices-multi-region#plan-for-multiregion-deployment).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-375">This pattern is also a [best practice for (managed) AKS clusters in Azure](/azure/aks/operator-best-practices-multi-region#plan-for-multiregion-deployment).</span></span>

<span data-ttu-id="d4f2f-376">Der Kubernetes-Cluster selbst, der über die AKS-Engine bereitgestellt wird, sollte mindestens aus drei Masterknoten und zwei Workerknoten bestehen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-376">The Kubernetes cluster itself, deployed via AKS Engine, should consist of at least three master nodes and two worker nodes.</span></span>

## <a name="identity-and-security-considerations"></a><span data-ttu-id="d4f2f-377">Überlegungen zu Identität und Sicherheit</span><span class="sxs-lookup"><span data-stu-id="d4f2f-377">Identity and security considerations</span></span>

<span data-ttu-id="d4f2f-378">Die Identität und die Sicherheit sind wichtige Themen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-378">Identity and security are important topics.</span></span> <span data-ttu-id="d4f2f-379">Dies gilt vor allem, wenn die Lösung unabhängige Azure Stack Hub-Instanzen umfasst.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-379">Especially when the solution spans independent Azure Stack Hub instances.</span></span> <span data-ttu-id="d4f2f-380">Sowohl Kubernetes als auch Azure (einschließlich Azure Stack Hub) verfügt über eigene Mechanismen für die rollenbasierte Zugriffssteuerung (RBAC):</span><span class="sxs-lookup"><span data-stu-id="d4f2f-380">Kubernetes and Azure (including Azure Stack Hub) both have distinct mechanisms for role-based access control (RBAC):</span></span>

- <span data-ttu-id="d4f2f-381">Mit der rollenbasierten Zugriffssteuerung von Azure wird der Zugriff auf Ressourcen in Azure (und Azure Stack Hub) gesteuert, z. B. auch die Möglichkeit zum Erstellen neuer Azure-Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-381">Azure RBAC controls access to resources in Azure (and Azure Stack Hub), including the ability to create new Azure resources.</span></span> <span data-ttu-id="d4f2f-382">Berechtigungen können Benutzern, Gruppen oder Dienstprinzipalen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-382">Permissions can be assigned to users, groups, or service principals.</span></span> <span data-ttu-id="d4f2f-383">(Ein Dienstprinzipal ist eine Sicherheitsidentität, die von Anwendungen verwendet wird.)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-383">(A service principal is a security identity used by applications.)</span></span>
- <span data-ttu-id="d4f2f-384">Mit der rollenbasierten Zugriffssteuerung von Kubernetes werden die Berechtigungen für die Kubernetes-API gesteuert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-384">Kubernetes RBAC controls permissions to the Kubernetes API.</span></span> <span data-ttu-id="d4f2f-385">Beispielsweise sind das Erstellen und Auflisten von Pods Aktionen, die per RBAC für einen Benutzer autorisiert (oder abgelehnt) werden können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-385">For example, creating pods and listing pods are actions that can be authorized (or denied) to a user through RBAC.</span></span> <span data-ttu-id="d4f2f-386">Zum Zuweisen von Kubernetes-Berechtigungen zu Benutzern erstellen Sie Rollen und Rollenbindungen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-386">To assign Kubernetes permissions to users, you create roles and role bindings.</span></span>

<span data-ttu-id="d4f2f-387">**Azure Stack Hub-Identität und RBAC**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-387">**Azure Stack Hub identity and RBAC**</span></span>

<span data-ttu-id="d4f2f-388">Für Azure Stack Hub können zwei Identitätsanbieter ausgewählt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-388">Azure Stack Hub provides two identity provider choices.</span></span> <span data-ttu-id="d4f2f-389">Die Auswahl des Anbieters hängt davon ab, welche Umgebung Sie verwenden und ob die Ausführung in einer verbundenen oder nicht verbundenen Umgebung erfolgt:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-389">The provider you use depends on the environment and whether running in a connected or disconnected environment:</span></span>

- <span data-ttu-id="d4f2f-390">Azure AD: Kann nur in einer verbundenen Umgebung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-390">Azure AD - can only be used in a connected environment.</span></span>
- <span data-ttu-id="d4f2f-391">ADFS für herkömmliche Active Directory-Gesamtstruktur: Kann sowohl in einer verbundenen als auch in einer nicht verbundenen Umgebung genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-391">ADFS to a traditional Active Directory forest - can be used in both a connected or disconnected environment.</span></span>

<span data-ttu-id="d4f2f-392">Der Identitätsanbieter verwaltet Benutzer und Gruppen, einschließlich der Authentifizierung und Autorisierung für den Zugriff auf Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-392">The identity provider manages users and groups, including authentication and authorization for accessing resources.</span></span> <span data-ttu-id="d4f2f-393">Es kann der Zugriff auf Azure Stack Hub-Ressourcen, z. B. Abonnements, Ressourcengruppen und einzelne Ressourcen wie VMs oder Lastenausgleichsmodule gewährt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-393">Access can be granted to Azure Stack Hub resources like subscriptions, resource groups, and individual resources like VMs or load balancers.</span></span> <span data-ttu-id="d4f2f-394">Um ein einheitliches Zugriffsmodell zu erhalten, sollten Sie erwägen, die gleichen Gruppen (entweder direkt oder geschachtelt) für alle Azure Stack Hub-Instanzen zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-394">To have a consistent access model, you should consider using the same groups (either direct or nested) for all Azure Stack Hubs.</span></span> <span data-ttu-id="d4f2f-395">Hier ist ein Konfigurationsbeispiel angegeben:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-395">Here's a configuration example:</span></span>

![Geschachtelte AAD-Gruppen mit Azure Stack Hub](media/pattern-highly-available-kubernetes/azure-stack-azure-ad-nested-groups.png)

<span data-ttu-id="d4f2f-397">Das Beispiel enthält eine dedizierte Gruppe (mit AAD oder ADFS) für einen bestimmten Zweck.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-397">The example contains a dedicated group (using AAD or ADFS) for a specific purpose.</span></span> <span data-ttu-id="d4f2f-398">Ein Beispiel hierfür ist das Bereitstellen von Berechtigungen vom Typ „Mitwirkender“ für die Ressourcengruppe, die unsere Infrastruktur für Kubernetes-Cluster auf einer bestimmten Azure Stack Hub-Instanz (hier „Seattle K8s Cluster Contributor“) enthält.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-398">For example, to provide Contributor permissions for the Resource Group that contains our Kubernetes cluster infrastructure on a specific Azure Stack Hub instance (here "Seattle K8s Cluster Contributor").</span></span> <span data-ttu-id="d4f2f-399">Diese Gruppen werden dann in einer übergeordneten Gruppe geschachtelt, in der die „Untergruppen“ für die einzelnen Azure Stack Hub-Instanzen enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-399">These groups are then nested into an overall group that contains the "subgroups" for each Azure Stack Hub.</span></span>

<span data-ttu-id="d4f2f-400">Unser Beispielbenutzer verfügt jetzt über Berechtigungen vom Typ „Mitwirkender“ für beide Ressourcengruppen mit allen Ressourcen der Kubernetes-Infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-400">Our sample user will now have "Contributor" permissions to both Resources Groups that contain the entire set of Kubernetes infrastructure resources.</span></span> <span data-ttu-id="d4f2f-401">Der Benutzer hat Zugriff auf Ressourcen auf beiden Azure Stack Hub-Instanzen, da für die Instanzen derselbe Identitätsanbieter verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-401">The user will have access to resources on both Azure Stack Hub instances, because the instances share the same identity provider.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d4f2f-402">Diese Berechtigungen betreffen nur Azure Stack Hub und einige der zugehörigen bereitgestellten Ressourcen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-402">These permissions affect only Azure Stack Hub and some of the resources deployed on top of it.</span></span> <span data-ttu-id="d4f2f-403">Ein Benutzer mit diesen Zugriffsberechtigungen kann viel Schaden anrichten, aber er hat keinen Zugriff auf die Kubernetes-IaaS-VMs oder die Kubernetes-API, ohne dass ihm zusätzliche Zugriffsberechtigungen für die Kubernetes-Bereitstellung gewährt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-403">A user who has this level of access can do a lot of harm, but cannot access the Kubernetes IaaS VMs nor the Kubernetes API without additional access to the Kubernetes deployment.</span></span>

<span data-ttu-id="d4f2f-404">**Kubernetes-Identität und RBAC**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-404">**Kubernetes identity and RBAC**</span></span>

<span data-ttu-id="d4f2f-405">Für einen Kubernetes-Cluster wird standardmäßig nicht derselbe Identitätsanbieter wie für die zugrunde liegende Azure Stack Hub-Instanz verwendet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-405">A Kubernetes cluster, by default, doesn't use the same Identity Provider as the underlaying Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-406">Für die VMs, auf denen der Kubernetes-Cluster und die Master- und Workerknoten gehostet werden, wird der SSH-Schlüssel genutzt, der während der Bereitstellung des Clusters angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-406">The VMs hosting the Kubernetes cluster, the master, and worker nodes, use the SSH Key that is specified during the deployment of the cluster.</span></span> <span data-ttu-id="d4f2f-407">Dieser SSH-Schlüssel wird benötigt, um per SSH eine Verbindung mit diesen Knoten herzustellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-407">This SSH key is required to connect to these nodes using SSH.</span></span>

<span data-ttu-id="d4f2f-408">Die Kubernetes-API (z. B. beim Zugriff mit `kubectl`) ist auch durch Dienstkonten geschützt, z. B. ein Standarddienstkonto vom Typ „Clusteradministrator“.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-408">The Kubernetes API (for example, accessed by using `kubectl`) is also protected by service accounts including a default "cluster admin" service account.</span></span> <span data-ttu-id="d4f2f-409">Die Anmeldeinformationen für dieses Dienstkonto werden anfänglich in der `.kube/config`-Datei auf Ihren Kubernetes-Masterknoten gespeichert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-409">The credentials for this service account are initially stored in the `.kube/config` file on your Kubernetes master nodes.</span></span>

<span data-ttu-id="d4f2f-410">**Geheimnisverwaltung und Anwendungsanmeldeinformationen**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-410">**Secrets management and application credentials**</span></span>

<span data-ttu-id="d4f2f-411">Beim Speichern von Geheimnissen, z. B. Verbindungszeichenfolgen oder Datenbankanmeldeinformationen, haben Sie mehrere Optionen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-411">To store secrets like connection strings or database credentials there are several choices, including:</span></span>

- <span data-ttu-id="d4f2f-412">Azure-Schlüsseltresor</span><span class="sxs-lookup"><span data-stu-id="d4f2f-412">Azure Key Vault</span></span>
- <span data-ttu-id="d4f2f-413">Kubernetes-Geheimnisse</span><span class="sxs-lookup"><span data-stu-id="d4f2f-413">Kubernetes Secrets</span></span>
- <span data-ttu-id="d4f2f-414">Drittanbieterlösungen, z. B. HashiCorp Vault (unter Kubernetes)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-414">3rd-Party solutions like HashiCorp Vault (running on Kubernetes)</span></span>

<span data-ttu-id="d4f2f-415">Achten Sie darauf, dass Sie Geheimnisse oder Anmeldeinformationen nicht als Klartext in Ihren Konfigurationsdateien, im Anwendungscode oder in Skripts speichern.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-415">Do not store secrets or credentials in plaintext in your configuration files, application code, or within scripts.</span></span> <span data-ttu-id="d4f2f-416">Speichern Sie diese Daten auch nicht in einem Versionskontrollsystem.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-416">And do not store them in a version control system.</span></span> <span data-ttu-id="d4f2f-417">Stattdessen sollten die Geheimnisse bei Bedarf über die Bereitstellungsautomatisierung abgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-417">Instead, the deployment automation should retrieve the secrets as needed.</span></span>

## <a name="patch-and-update"></a><span data-ttu-id="d4f2f-418">Patch und Update</span><span class="sxs-lookup"><span data-stu-id="d4f2f-418">Patch and update</span></span>

<span data-ttu-id="d4f2f-419">Der Prozess **Patch und Update (PNU)** in Azure Kubernetes Service ist teilweise automatisiert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-419">The **Patch and Update (PNU)** process in Azure Kubernetes Service is partially automated.</span></span> <span data-ttu-id="d4f2f-420">Upgrades der Kubernetes-Version werden manuell ausgelöst, während Sicherheitsupdates automatisch angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-420">Kubernetes version upgrades are triggered manually, while security updates are applied automatically.</span></span> <span data-ttu-id="d4f2f-421">Diese Updates können Sicherheitsfixes oder Kernelupdates für das Betriebssystem enthalten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-421">These updates can include OS security fixes or kernel updates.</span></span> <span data-ttu-id="d4f2f-422">AKS startet diese Linux-Knoten nicht automatisch neu, um das Update abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-422">AKS doesn't automatically reboot these Linux nodes to complete the update process.</span></span> 

<span data-ttu-id="d4f2f-423">Der PNU-Prozess für einen Kubernetes-Cluster, der per AKS-Engine unter Azure Stack Hub bereitgestellt wird, wird nicht verwaltet, sodass die Verantwortung dafür beim Operator des Clusters liegt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-423">The PNU process for a Kubernetes cluster deployed using AKS Engine on Azure Stack Hub is unmanaged, and is the responsibility of the cluster operator.</span></span> 

<span data-ttu-id="d4f2f-424">Die AKS-Engine dient als Unterstützung bei den beiden wichtigsten Aufgaben:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-424">AKS Engine helps with the two most important tasks:</span></span>

- [<span data-ttu-id="d4f2f-425">Upgrade auf eine neuere Version von Kubernetes und des Betriebssystem-Basisimages</span><span class="sxs-lookup"><span data-stu-id="d4f2f-425">Upgrade to a newer Kubernetes and base OS image version</span></span>](/azure-stack/user/azure-stack-kubernetes-aks-engine-upgrade#steps-to-upgrade-to-a-newer-kubernetes-version)
- [<span data-ttu-id="d4f2f-426">Alleiniges Upgrade des Betriebssystem-Basisimages</span><span class="sxs-lookup"><span data-stu-id="d4f2f-426">Upgrade the base OS image only</span></span>](/azure-stack/user/azure-stack-kubernetes-aks-engine-upgrade#steps-to-only-upgrade-the-os-image)

<span data-ttu-id="d4f2f-427">Neuere Betriebssystem-Basisimages enthalten die aktuellen Sicherheitsfixes und Kernelupdates für das Betriebssystem.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-427">Newer base OS images contain the latest OS security fixes and kernel updates.</span></span> 

<span data-ttu-id="d4f2f-428">Mit dem Mechanismus [Unattended Upgrade (Unbeaufsichtigtes Upgrade)](https://wiki.debian.org/UnattendedUpgrades) werden automatisch Sicherheitsupdates installiert, die veröffentlicht werden, bevor auf dem Azure Stack Hub Marketplace eine neue Version des Betriebssystem-Basisimages verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-428">The [Unattended Upgrade](https://wiki.debian.org/UnattendedUpgrades) mechanism automatically installs security updates that are released before a new base OS image version is available in the Azure Stack Hub Marketplace.</span></span> <span data-ttu-id="d4f2f-429">Das unbeaufsichtigte Upgrade ist standardmäßig aktiviert, und die Sicherheitsupdates werden automatisch installiert, aber die Kubernetes-Clusterknoten werden nicht neu gestartet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-429">Unattended upgrade is enabled by default and installs security updates automatically, but does not reboot the Kubernetes cluster nodes.</span></span> <span data-ttu-id="d4f2f-430">Das Neustarten der Knoten kann automatisiert werden, indem der Open-Source-Daemon [**K** Ubernetes **RE** boot **D** aemon (kured))](/azure/aks/node-updates-kured) verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-430">Rebooting the nodes can be automated using the open-source [**K** Ubernetes **RE** boot **D** aemon (kured))](/azure/aks/node-updates-kured).</span></span> <span data-ttu-id="d4f2f-431">Bei kured wird auf Linux-Knoten geachtet, für die ein Neustart erforderlich ist, und anschließend werden automatisch die erneute Planung der Podausführung und der Prozess für den Knotenneustart durchgeführt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-431">Kured watches for Linux nodes that require a reboot, then automatically handle the rescheduling of running pods and node reboot process.</span></span>

## <a name="deployment-cicd-considerations"></a><span data-ttu-id="d4f2f-432">Bereitstellungsaspekte (CI/CD)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-432">Deployment (CI/CD) considerations</span></span>

<span data-ttu-id="d4f2f-433">Für Azure und Azure Stack Hub werden die gleichen Azure Resource Manager-REST-APIs verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-433">Azure and Azure Stack Hub expose the same Azure Resource Manager REST APIs.</span></span> <span data-ttu-id="d4f2f-434">Diese APIs werden genauso wie andere Azure-Clouds (Azure, Azure China 21Vianet, Azure Government) kontaktiert.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-434">These APIs are addressed like any other Azure cloud (Azure, Azure China 21Vianet, Azure Government).</span></span> <span data-ttu-id="d4f2f-435">Zwischen Clouds können Unterschiede bei den API-Versionen bestehen, und von Azure Stack Hub wird nur ein Teil der Dienste bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-435">There may be differences in API versions between clouds, and Azure Stack Hub provides only a subset of services.</span></span> <span data-ttu-id="d4f2f-436">Auch der URI der Verwaltungsendpunkte variiert von Cloud zu Cloud und für die einzelnen Azure Stack Hub-Instanzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-436">The management endpoint URI is also different for each cloud, and each instance of Azure Stack Hub.</span></span>

<span data-ttu-id="d4f2f-437">Abgesehen von diesen geringfügigen Unterschieden stellen Azure Resource Manager-REST-APIs eine einheitliche Möglichkeit zur Interaktion mit Azure und Azure Stack Hub dar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-437">Aside from the subtle differences mentioned, Azure Resource Manager REST APIs provide a consistent way to interact with both Azure and Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-438">Hierfür können die gleichen Tools wie für andere Azure-Clouds genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-438">The same set of tools can be used here as would be used with any other Azure cloud.</span></span> <span data-ttu-id="d4f2f-439">Sie können Azure DevOps, ein Tool wie Jenkins oder PowerShell verwenden, um Dienste für Azure Stack Hub bereitzustellen und zu orchestrieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-439">You can use Azure DevOps, tools like Jenkins, or PowerShell, to deploy and orchestrate services to Azure Stack Hub.</span></span>

<span data-ttu-id="d4f2f-440">**Überlegungen**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-440">**Considerations**</span></span>

<span data-ttu-id="d4f2f-441">Eines der wichtigsten Merkmale von Azure Stack Hub-Bereitstellungen ist die Zugänglichkeit über das Internet.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-441">One of the major differences when it comes to Azure Stack Hub deployments is the question of Internet accessibility.</span></span> <span data-ttu-id="d4f2f-442">Die Zugänglichkeit über das Internet bestimmt, ob für Ihre CI/CD-Aufträge ein von Microsoft gehosteter oder ein selbstgehosteter Build-Agent gewählt werden muss.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-442">Internet accessibility determines whether to select a Microsoft-hosted or a self-hosted build agent for your CI/CD jobs.</span></span>

<span data-ttu-id="d4f2f-443">Ein selbstgehosteter Agent kann zusätzlich zu Azure Stack Hub (als IaaS-VM) oder in einem Subnetz des Netzwerks mit Zugriff auf Azure Stack Hub ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-443">A self-hosted agent can run on top of Azure Stack Hub (as an IaaS VM) or in a network subnet that can access Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-444">Weitere Informationen zu den Unterschieden finden Sie unter [Azure Pipelines-Agents](/azure/devops/pipelines/agents/agents).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-444">Go to [Azure Pipelines agents](/azure/devops/pipelines/agents/agents) to learn more about the differences.</span></span>

<span data-ttu-id="d4f2f-445">Die folgende Abbildung dient als Hilfe beim Treffen der Entscheidung, ob Sie einen selbstgehosteten oder einen von Microsoft gehosteten Build-Agent benötigen:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-445">The following image helps you to decide if you need a self-hosted or a Microsoft-hosted build agent:</span></span>

![Selbstgehostete Build-Agents: Entscheidungshilfe](media/pattern-highly-available-kubernetes/aks-on-stack-self-hosted-build-agents-yes-or-no.png)

- <span data-ttu-id="d4f2f-447">Sind die Azure Stack Hub-Verwaltungsendpunkte über das Internet zugänglich?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-447">Are the Azure Stack Hub management endpoints accessible via Internet?</span></span>
  - <span data-ttu-id="d4f2f-448">Ja: Wir können Azure Pipelines mit von Microsoft gehosteten Agents verwenden, um eine Verbindung mit Azure Stack Hub herzustellen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-448">Yes: We can use Azure Pipelines with Microsoft-hosted agents to connect to Azure Stack Hub.</span></span>
  - <span data-ttu-id="d4f2f-449">Nein: Wir benötigen selbstgehostete Agents, die eine Verbindung mit den Verwaltungsendpunkten von Azure Stack Hub herstellen können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-449">No: We need self-hosted agents that can connect to Azure Stack Hub's management endpoints.</span></span>
- <span data-ttu-id="d4f2f-450">Ist unser Kubernetes-Cluster über das Internet zugänglich?</span><span class="sxs-lookup"><span data-stu-id="d4f2f-450">Is our Kubernetes cluster accessible via the Internet?</span></span>
  - <span data-ttu-id="d4f2f-451">Ja: Wir können Azure Pipelines mit von Microsoft gehosteten Agents verwenden, um direkt mit dem Kubernetes-API-Endpunkt zu interagieren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-451">Yes: We can use Azure Pipelines with Microsoft-hosted agents to interact directly with Kubernetes API endpoint.</span></span>
  - <span data-ttu-id="d4f2f-452">Nein: Wir benötigen selbstgehostete Agents, die eine Verbindung mit dem API-Endpunkt des Kubernetes-Clusters herstellen können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-452">No: We need self-hosted Agents that can connect to the Kubernetes cluster API endpoint.</span></span>

<span data-ttu-id="d4f2f-453">In Szenarien, in denen die Azure Stack Hub-Verwaltungsendpunkte und die Kubernetes-API über das Internet zugänglich sind, kann für die Bereitstellung ein von Microsoft gehosteter Agent genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-453">In scenarios where the Azure Stack Hub management endpoints and Kubernetes API are accessible via the internet, the deployment can use a Microsoft-hosted agent.</span></span> <span data-ttu-id="d4f2f-454">Diese Bereitstellung führt zur folgenden Anwendungsarchitektur:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-454">This deployment will result in an application architecture as follows:</span></span>

<span data-ttu-id="d4f2f-455">[![Übersicht über die öffentliche Architektur](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern.png)](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern.png#lightbox)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-455">[![Public architecture overview](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern.png)](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern.png#lightbox)</span></span>

<span data-ttu-id="d4f2f-456">Falls die Azure Resource Manager-Endpunkte, die Kubernetes-API oder beide Komponenten nicht direkt über das Internet zugänglich sind, können wir einen selbstgehosteten Build-Agent nutzen, um die Pipelineschritte auszuführen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-456">If the Azure Resource Manager endpoints, Kubernetes API, or both aren't directly accessible via the Internet, we can leverage a self-hosted build agent to run the pipeline steps.</span></span> <span data-ttu-id="d4f2f-457">Bei diesem Entwurf sind die Konnektivitätsanforderungen geringer, und es ist eine Bereitstellung nur mit einer lokalen Netzwerkverbindung mit Azure Resource Manager-Endpunkten und der Kubernetes-API möglich:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-457">This design needs less connectivity, and can be deployed with only on-premises network connectivity to Azure Resource Manager endpoints and the Kubernetes API:</span></span>

<span data-ttu-id="d4f2f-458">[![Übersicht über die lokale Architektur](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern-self-hosted.png)](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern-self-hosted.png#lightbox)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-458">[![On-prem architecture overview](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern-self-hosted.png)](media/pattern-highly-available-kubernetes/aks-azure-stack-app-pattern-self-hosted.png#lightbox)</span></span>

> [!NOTE]
> <span data-ttu-id="d4f2f-459">**Wie sieht es bei Szenarien ohne Verbindung aus?**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-459">**What about disconnected scenarios?**</span></span> <span data-ttu-id="d4f2f-460">In Szenarien, in denen Azure Stack Hub, Kubernetes oder beide Systeme nicht über per Internet zugängliche Verwaltungsendpunkte verfügen, können Sie trotzdem Azure DevOps für Ihre Bereitstellungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-460">In scenarios where either Azure Stack Hub or Kubernetes or both of them do not have internet-facing management endpoints, it is still possible to use Azure DevOps for your deployments.</span></span> <span data-ttu-id="d4f2f-461">Sie können entweder einen selbstgehosteten Agent-Pool (lokal oder unter Azure Stack Hub ausgeführter DevOps-Agent) oder eine vollständig selbstgehostete Azure DevOps Server-Instanz lokal verwenden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-461">You can either use a self-hosted Agent Pool (which is a DevOps Agent running on-premises or on Azure Stack Hub itself) or a completly self-hosted Azure DevOps Server on-premises.</span></span> <span data-ttu-id="d4f2f-462">Der selbstgehostete Agent benötigt nur eine HTTPS-Internetverbindung (TCP/443) in ausgehender Richtung.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-462">The self-hosted agent needs only outbound HTTPS (TCP/443) Internet connectivity.</span></span>

<span data-ttu-id="d4f2f-463">Bei diesem Muster kann ein Kubernetes-Cluster (Bereitstellung und Orchestrierung per AKS-Engine) auf jeder Azure Stack Hub-Instanz verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-463">The pattern can use a Kubernetes cluster (deployed and orchestrated with AKS engine) on each Azure Stack Hub instance.</span></span> <span data-ttu-id="d4f2f-464">Dies umfasst eine Anwendung mit einem Front-End, einer Mid-Tier-Komponente, Back-End-Diensten (z. B. MongoDB) und einem NGINX-basierten Eingangsdatencontroller.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-464">It includes an application consisting of a frontend, a mid-tier, backend services (for example MongoDB), and an nginx-based Ingress Controller.</span></span> <span data-ttu-id="d4f2f-465">Anstatt eine Datenbank zu verwenden, die im K8s-Cluster gehostet wird, können Sie „externe Datenspeicher“ nutzen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-465">Instead of using a database hosted on the K8s cluster, you can leverage "external data stores".</span></span> <span data-ttu-id="d4f2f-466">Beispiele für Datenbankoptionen sind MySQL, SQL Server und alle Arten von Datenbanken, die außerhalb von Azure Stack Hub oder per IaaS gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-466">Database options include MySQL, SQL Server, or any kind of database hosted outside of Azure Stack Hub or in IaaS.</span></span> <span data-ttu-id="d4f2f-467">Diese Konfigurationen können hier aber nicht ausführlicher beschrieben werden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-467">Configurations like this aren't in scope here.</span></span>

## <a name="partner-solutions"></a><span data-ttu-id="d4f2f-468">Partnerlösungen</span><span class="sxs-lookup"><span data-stu-id="d4f2f-468">Partner solutions</span></span>

<span data-ttu-id="d4f2f-469">Es sind Lösungen von Microsoft-Partnern erhältlich, mit denen die Funktionen von Azure Stack Hub erweitert werden können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-469">There are Microsoft Partner solutions that can extend the capabilities of Azure Stack Hub.</span></span> <span data-ttu-id="d4f2f-470">Diese Lösungen haben sich in Bereitstellungen von Anwendungen, die in Kubernetes-Clustern ausgeführt werden, als nützlich erwiesen.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-470">These solutions have been found useful in deployments of applications running on Kubernetes clusters.</span></span>  

## <a name="storage-and-data-solutions"></a><span data-ttu-id="d4f2f-471">Speicher- und Datenlösungen</span><span class="sxs-lookup"><span data-stu-id="d4f2f-471">Storage and data solutions</span></span>

<span data-ttu-id="d4f2f-472">Wie unter [Überlegungen zu Daten und Speicher](#data-and-storage-considerations) beschrieben, ist für Azure Stack Hub derzeit keine native Lösung zum übergreifenden Replizieren von Speicher für mehrere Instanzen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-472">As described in [Data and storage considerations](#data-and-storage-considerations), Azure Stack Hub currently doesn't have a native solution to replicate storage across multiple instances.</span></span> <span data-ttu-id="d4f2f-473">Im Gegensatz zu Azure ist die Funktion zum Replizieren von Speicher in mehreren Regionen nicht vorhanden.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-473">Unlike Azure, the capability of replicating storage across multiple regions does not exist.</span></span> <span data-ttu-id="d4f2f-474">In Azure Stack Hub stellt jede Instanz eine eigene Cloud dar.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-474">In Azure Stack Hub, each instance is its own distinct cloud.</span></span> <span data-ttu-id="d4f2f-475">Es gibt aber Lösungen von Microsoft-Partnern, mit denen die übergreifende Speicherreplikation für Azure Stack Hub-Instanzen und Azure ermöglicht wird.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-475">However, solutions are available from Microsoft Partners that enable storage replication across Azure Stack Hubs and Azure.</span></span> 

<span data-ttu-id="d4f2f-476">**SCALITY**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-476">**SCALITY**</span></span>

<span data-ttu-id="d4f2f-477">[Scality](https://www.scality.com/) stellt schon seit 2009 Webspeicher für die digitalen Anforderungen von Unternehmen zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-477">[Scality](https://www.scality.com/) delivers web-scale storage that has powered digital businesses since 2009.</span></span> <span data-ttu-id="d4f2f-478">Mit dem softwaredefinierten Speicher „Scality RING“ werden handelsübliche x86-Server zu einem unbegrenzten Petabyte-Speicherpool für alle Arten von Daten (Dateien oder Objekte).</span><span class="sxs-lookup"><span data-stu-id="d4f2f-478">The Scality RING, our software-defined storage, turns commodity x86 servers into an unlimited storage pool for any type of data –file and object– at petabyte scale.</span></span>

<span data-ttu-id="d4f2f-479">**CLOUDIAN**</span><span class="sxs-lookup"><span data-stu-id="d4f2f-479">**CLOUDIAN**</span></span>

<span data-ttu-id="d4f2f-480">[Cloudian](https://www.cloudian.com/) erleichtert Unternehmen die Erfüllung von Speicheranforderungen durch die Bereitstellung von unbegrenztem skalierbarem Speicher, mit dem sehr große Datasets zur Vereinfachung der Verwaltung in einer zentralen Umgebung zusammengefasst werden können.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-480">[Cloudian](https://www.cloudian.com/) simplifies enterprise storage with limitless scalable storage that consolidates massive data sets to a single, easily managed environment.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d4f2f-481">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="d4f2f-481">Next steps</span></span>

<span data-ttu-id="d4f2f-482">Weitere Informationen zu den in diesem Artikel behandelten Konzepten:</span><span class="sxs-lookup"><span data-stu-id="d4f2f-482">To learn more about concepts introduced in this article:</span></span>

- <span data-ttu-id="d4f2f-483">[Cloudübergreifende Skalierung](pattern-cross-cloud-scale.md) und [Muster für geografisch verteilte Apps](pattern-geo-distributed.md) in Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="d4f2f-483">[Cross-cloud scaling](pattern-cross-cloud-scale.md) and [Geo-distributed app patterns](pattern-geo-distributed.md) in Azure Stack Hub.</span></span>
- <span data-ttu-id="d4f2f-484">[Microservicearchitektur in Azure Kubernetes Service (AKS)](/azure/architecture/reference-architectures/microservices/aks)</span><span class="sxs-lookup"><span data-stu-id="d4f2f-484">[Microservices architecture on Azure Kubernetes Service (AKS)](/azure/architecture/reference-architectures/microservices/aks).</span></span>

<span data-ttu-id="d4f2f-485">Wenn Sie zum Testen des Lösungsbeispiels bereit sind, können Sie mit dem Artikel [Bereitstellen eines Kubernetes-Hochverfügbarkeitsclusters in Azure Stack Hub](solution-deployment-guide-highly-available-kubernetes.md) fortfahren.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-485">When you're ready to test the solution example, continue with the [High availability Kubernetes cluster deployment guide](solution-deployment-guide-highly-available-kubernetes.md).</span></span> <span data-ttu-id="d4f2f-486">In diesem Bereitstellungsleitfaden finden Sie detaillierte Anweisungen zum Bereitstellen und Testen der zugehörigen Komponenten.</span><span class="sxs-lookup"><span data-stu-id="d4f2f-486">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>